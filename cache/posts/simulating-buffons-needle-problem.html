<p>Buffon's needle problem is a classic problem on geometric probability. mathworld describes the problem quite well, and gives the following formula for the probability that the needle touches a line:</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}(x)=\begin{cases} \dfrac{2}{\pi}\, x&amp; x\le 1\\ &amp; \\ \dfrac{2}{\pi}\, \left(x-\sqrt{x^2-1}+\sec^{-1}{x}\right)&amp; x&gt;1 \end{cases}
\end{equation*}
</div>
<p>How can we convince ourselves that the formula has been derived correctly? How to simulate geometric shapes?</p>
<p>The answer is to use the parametric representation of the points. If the needle of length <span class="math">\(l\)</span> is dropped, then it makes an angle <span class="math">\(\theta\)</span> with the horizontal. For simulating, take one end of the needle as a reference, and it must be randomly and uniformly distributed in <span class="math">\([0,d)\)</span>. Call the random number as <span class="math">\(h\)</span>. The other end of the needle will then be at a distance <span class="math">\(h+l\cdot sin(\theta)\)</span>.</p>
<p>Now, for the condition that the needle touches the line, the other end must be either higher than <span class="math">\(d\)</span> or less than zero. Hence, we can simulate the experiment by picking <span class="math">\(h\)</span> in <span class="math">\(U(0,d)\)</span> and <span class="math">\(\theta \in U(0,2\, \theta)\)</span>.</p>
<p>Following is the code in J:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_7872735186e145ea946f22d2cedf8572-0">0</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-1">1</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-2">2</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-3">3</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-4">4</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-5">5</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-6">6</a>
<a href="#rest_code_7872735186e145ea946f22d2cedf8572-7">7</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_7872735186e145ea946f22d2cedf8572-0"></a>load &#39;trig&#39;
<a name="rest_code_7872735186e145ea946f22d2cedf8572-1"></a>&#39;l d&#39;=:4 1
<a name="rest_code_7872735186e145ea946f22d2cedf8572-2"></a>    sim =: 3 : 0
<a name="rest_code_7872735186e145ea946f22d2cedf8572-3"></a>h=:d*?1000000#0
<a name="rest_code_7872735186e145ea946f22d2cedf8572-4"></a>th=:2p1*?1000000#0
<a name="rest_code_7872735186e145ea946f22d2cedf8572-5"></a>(+/%#)((h+l*sin th)&gt;d)+.((h+l*sin th)&lt;0)
<a name="rest_code_7872735186e145ea946f22d2cedf8572-6"></a>)
<a name="rest_code_7872735186e145ea946f22d2cedf8572-7"></a>    sim 0
</pre></td></tr></table><p>It gives an answer about <span class="math">\(0.919978\)</span>, and changing <span class="math">\(l\)</span> and <span class="math">\(d\)</span> to</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_94fd1426372946a7b7665a0a1716c7ec-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_94fd1426372946a7b7665a0a1716c7ec-0"></a>&#39;l d&#39;=:1 4
</pre></td></tr></table><p>gives about <span class="math">\(0.15907\)</span>, which are close to actual answers <span class="math">\(0.920000066713994\)</span> and <span class="math">\(0.159154943091895\)</span>, respectively.</p>
