<p>We will see some more problems on probability, and how to do it in J.</p>
<div class="section" id="derangement-problem">
<h1>1 Derangement problem</h1>
<p><em>There are 30 boxes numbered 1 to 30, and 30 balls numbered 1 to 30. If the balls are put into the boxes (one in each) randomly, what's the probability that none of the balls are put in the boxes with matching number?</em></p>
<p>By simulation:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_00bd5b77377f42cd872617e70eca6959-0">0</a>
<a href="#rest_code_00bd5b77377f42cd872617e70eca6959-1">1</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_00bd5b77377f42cd872617e70eca6959-0"></a>sim=: 3 : &#39;0=+/(i.30)=30?30&#39;
<a name="rest_code_00bd5b77377f42cd872617e70eca6959-1"></a>(+/%#)(sim&quot;0)100000#0
</pre></td></tr></table><p>The analytical answer:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_6b252df14dad450fbfca5e07a196cd65-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_6b252df14dad450fbfca5e07a196cd65-0"></a>+/((30$(1 _1))*(%!i.30))
</pre></td></tr></table></div>
<div class="section" id="urns-balls-and-a-gamble">
<h1>2 Urns, balls and a gamble.</h1>
<p>A game is played with the following rules: There is an urn with 20 balls, 10 red and 10 white. You need pick 10 balls out of these 20.</p>
<ol class="arabic simple">
<li>If 10 balls are of the same color, you get $300</li>
<li>If 9 balls are of the same color, you get $30</li>
<li>If 8 balls are of the same color, you get $3</li>
<li>If 7 balls are of the same color, you get $2</li>
<li>If 6 balls are of the same color, you get $1</li>
<li>If 5 balls are of the same color, you lose $5</li>
</ol>
<p>What's your expected amount?</p>
<p>Simulation answer:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_2da4b0f4dce846228728fe394ce8bf85-0">0</a>
<a href="#rest_code_2da4b0f4dce846228728fe394ce8bf85-1">1</a>
<a href="#rest_code_2da4b0f4dce846228728fe394ce8bf85-2">2</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_2da4b0f4dce846228728fe394ce8bf85-0"></a>a=: 10#0 1
<a name="rest_code_2da4b0f4dce846228728fe394ce8bf85-1"></a>sim=: 3 : &#39;((_5 * 5 = ]) + ([: +/ 4 6 =/ ]) + (2 * [: +/ 3 7 =/ ]) + (3 * [: +/ 2 8 =/ ]) + (30 * [: +/ 1 9 =/ ]) + 300 * [: +/ 10 0 =/ ])+/(10?20){a&#39;
<a name="rest_code_2da4b0f4dce846228728fe394ce8bf85-2"></a>(+/%#)(sim&quot;0)1000000#0  NB. = _0.826702
</pre></td></tr></table><p>Analytical answer (hypergeometric distribution):</p>
<p><span class="math">\(A=\{1, 2, 3, 30, 300, -5\}\)</span></p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{i=0}^{4}\dfrac{A_i\cdot 2\, \dbinom{10}{i}\dbinom{10}{10-i}}{\dbinom{20}{10}}+\dfrac{A_5\cdot \dbinom{10}{5}^2}{\dbinom{20}{10}} =-\dfrac{76485}{92378}=-0.827956872848514
\end{equation*}
</div>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_cd0a4315f2194cbc9782a9ce90723916-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_cd0a4315f2194cbc9782a9ce90723916-0"></a>_5 1 2 3 30 300)*(((5!10)^2), (2 * (10 !~ ]) * 10 !~ 10 - ]) 6+i.5)%10!20
</pre></td></tr></table></div>
<div class="section" id="birthday-problem">
<h1>3 Birthday problem</h1>
<p>How many people should be in a room such that the probability of at least two of them sharing the same birthday is more than 0.5? (Assume 365 days in an year)</p>
<p>By Simulation:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_25f596979bec474797949b2a2560469d-0">0</a>
<a href="#rest_code_25f596979bec474797949b2a2560469d-1">1</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_25f596979bec474797949b2a2560469d-0"></a>sim=: 3 : &#39;23&gt;+/~:?23#365&#39;
<a name="rest_code_25f596979bec474797949b2a2560469d-1"></a>(+/%#)(sim&quot;0)100000#0
</pre></td></tr></table><p>Analytically:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_73e996cfa76f49a692c04f64b020ac2b-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_73e996cfa76f49a692c04f64b020ac2b-0"></a>1-*/((365-i.23)%(365)) NB. = 0.507297234323985
</pre></td></tr></table><p>To see a plot of the probabilities, up to 100 people in a room:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_10974293dec541da9f96c20c328bb2d2-0">0</a>
<a href="#rest_code_10974293dec541da9f96c20c328bb2d2-1">1</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_10974293dec541da9f96c20c328bb2d2-0"></a>load&#39;plot&#39;
<a name="rest_code_10974293dec541da9f96c20c328bb2d2-1"></a>&#39;marker&#39; plot (1+i.100);((1 - [: */ 365 %~ 365 - i.)&quot;0) 1+i.100
</pre></td></tr></table></div>
<div class="section" id="dice">
<h1>4 4 dice</h1>
<p>Four dice are rolled, what's the probability that no two faces are repeated? (E.g. 6 4 2 5 is okay, but 3 6 5 6 is forbidden)</p>
<p>By simulation:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_4b272ce45ce94172ac428966a9411340-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_4b272ce45ce94172ac428966a9411340-0"></a>sim=: 3 : &#39;(4 = [: +/ [: +/ =/~)?4#6&#39;
</pre></td></tr></table><p>By permutation:</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}=\dfrac{\dbinom{6}{4}\cdot 4!}{6^4} = \dfrac{5}{18} = 0.2777777
\end{equation*}
</div>
<p>Putting that in J console:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_edcba5fe8fad4fa7919baaa616cdebf1-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_edcba5fe8fad4fa7919baaa616cdebf1-0"></a>((4!6)*!4)%6^4
</pre></td></tr></table><p>By counting:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_a93b8895f62a4396a2d329263182c139-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_a93b8895f62a4396a2d329263182c139-0"></a>(+/4=+/&quot;1~:&quot;1(6 6 6 6#:i.1296))%6^4 NB. this uses base-6 representation till 6^4
</pre></td></tr></table></div>
<div class="section" id="the-ballot-problem">
<h1>5 The ballot problem</h1>
<p>In an election, candidate A receives n votes, and candidate B receives m votes where <span class="math">\(n &gt; m\)</span>. Assuming that all orderings are equally likely, show that the probability that A is always ahead in the count of votes is <span class="math">\(\dfrac{n - m}{n + m}\)</span>.</p>
<p>Here's a simulation to see that it may be true:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_dadddf9858b447c49e71a8948bc51a2e-0">0</a>
<a href="#rest_code_dadddf9858b447c49e71a8948bc51a2e-1">1</a>
<a href="#rest_code_dadddf9858b447c49e71a8948bc51a2e-2">2</a>
<a href="#rest_code_dadddf9858b447c49e71a8948bc51a2e-3">3</a>
<a href="#rest_code_dadddf9858b447c49e71a8948bc51a2e-4">4</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_dadddf9858b447c49e71a8948bc51a2e-0"></a>n=:55
<a name="rest_code_dadddf9858b447c49e71a8948bc51a2e-1"></a>m=:45
<a name="rest_code_dadddf9858b447c49e71a8948bc51a2e-2"></a>a=:(m#_1),n#1
<a name="rest_code_dadddf9858b447c49e71a8948bc51a2e-3"></a>sim=: 3 : &#39;100=+/0&lt;+/\(100?100){a&#39;
<a name="rest_code_dadddf9858b447c49e71a8948bc51a2e-4"></a>(+/%#)(sim&quot;0)100000#0 NB. = 0.0993
</pre></td></tr></table><p>which is close to 0.1 computed from the formula.</p>
</div>
<div class="section" id="an-ace-from-a-regular-deck-of-52-cards">
<h1>6 An ace from a regular deck of 52 cards</h1>
<p>A deck of cards is well shuffled, and placed face down on a table. The cards are picked one after another, what's the probability that you get to see the first ace when <span class="math">\(k^{th}\)</span> card is picked?</p>
<p>Finding the answer is quite easy, which is</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}(k)=\dfrac{\dbinom{48}{k-1}}{\dbinom{52}{k-1}}\cdot \dfrac{4}{52-k}
\end{equation*}
</div>
<p>and a simulation can back up our claim, e.g. for <span class="math">\(k=5\)</span>:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_d8f637b56c894ab0a76f914b12626d43-0">0</a>
<a href="#rest_code_d8f637b56c894ab0a76f914b12626d43-1">1</a>
<a href="#rest_code_d8f637b56c894ab0a76f914b12626d43-2">2</a>
<a href="#rest_code_d8f637b56c894ab0a76f914b12626d43-3">3</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_d8f637b56c894ab0a76f914b12626d43-0"></a>pos=: 5
<a name="rest_code_d8f637b56c894ab0a76f914b12626d43-1"></a>a=:(4#1),48#0
<a name="rest_code_d8f637b56c894ab0a76f914b12626d43-2"></a>sim=: 3 : &#39;pos=1+{.I.(52?52){a&#39;
<a name="rest_code_d8f637b56c894ab0a76f914b12626d43-3"></a>(+/%#)(sim&quot;0)100000#0
</pre></td></tr></table><p>and the probabilities for first five positions:</p>
<table class="codetable"><tr><td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_52894888dd4a4b61aad1fb1b1e2cbb90-0">0</a></pre></div></td><td class="code"><pre class="code text"><a name="rest_code_52894888dd4a4b61aad1fb1b1e2cbb90-0"></a>(((48 !~ 1 -~ ]) % 52 !~ 1 -~ ]) * 4 % 52 - 1 -~ ]) 1+i.5
</pre></td></tr></table></div>
