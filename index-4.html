<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Some random stuffs -- Programming and Mathematics">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gopinath A R (old posts, page 4) | Gopinath A R</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://g-ar.github.io/index-4.html">
<link rel="prev" href="index-5.html" type="text/html">
<link rel="next" href="index-3.html" type="text/html">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://g-ar.github.io/">

                <span id="blog-title">Gopinath A R</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>
                </li>
<li>
<a href="stories/about-me/">About</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/differentiation-under-the-integral-sign-and-a-sum/" class="u-url">Differentiation under the integral sign and a sum</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/differentiation-under-the-integral-sign-and-a-sum/" rel="bookmark"><time class="published dt-published" datetime="2014-04-22T15:10:49+05:30" title="2014-04-22 15:10">2014-04-22 15:10</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>We will see how differentiation under the integral sign, which Mr. Feynman loved, can be applied to derive an otherwise difficult integral.
The integral can also be expanded as a Taylor series, thus obtaining an infinite sum.</p>
<p>So, this is the integral:</p>
<div class="math">
\begin{equation*}
\displaystyle I(a)=\int_0^1 \, \frac{\ln{(1+a\,(x-x^2))}}{x-x^2}\, dx
\end{equation*}
</div>
<p>Applying the differentiation under the integral sign to this:</p>
<div class="math">
\begin{align*}
\displaystyle
\frac{\partial}{\partial a} I(a) &amp;= \int_0^1\, \frac{1}{1+a\,(x-x^2)}\, dx\\
&amp;=\frac{\log\left(\frac{1}{2} \, a + \frac{1}{2} \, \sqrt{a^{2} + 4 \, a} + 1\right)}{\sqrt{a^{2} + 4 \, a}} - \frac{\log\left(\frac{1}{2} \, a - \frac{1}{2} \, \sqrt{a^{2} + 4 \, a} + 1\right)}{\sqrt{a^{2} + 4 \, a}}
\end{align*}
</div>
<p>Integrating w.r.t <span class="math">\(a\)</span> gives us (answer by friCAS)</p>
<div class="math">
\begin{equation*}
\displaystyle I(a)=\log\left( \frac{a+2 -\sqrt{a^{2} + 4 \, a}}{2}\right)^{2} + C
\end{equation*}
</div>
<p>Putting <span class="math">\(a=0\)</span> in the above gives <span class="math">\(I(0)=0+C\)</span> and original integral is also 0. Hence, <span class="math">\(C=0\)</span> and the final answer to the integral is:</p>
<div class="math">
\begin{equation*}
\displaystyle I(a)=\log\left( \frac{a+2 -\sqrt{a^{2} + 4 \, a}}{2}\right)^{2}
\end{equation*}
</div>
<p>Now, we may also expand the integral as a taylor series:</p>
<div class="math">
\begin{align*}
\displaystyle
I(a)&amp;=\int_0^1 \, \sum_{n\ge 1}\, \frac{(-1)^{n-1}\, a^{n} (x-x^2)^n}{n\, (x-x^2)} \, dx\\
&amp;=\int_0^1 \, \sum_{n\ge 1}\, \frac{(-1)^{n-1}\, a^{i} (x-x^2)^{n-1}}{n} \, dx\\
&amp;=\int_0^1 \, \sum_{n\ge 0}\, \frac{(-1)^{n}\, a^{n+1} (x-x^2)^{n}}{n+1} \, dx\\
&amp;=\sum_{n\ge 0}\, \frac{(-1)^{n}\, a^{n+1} B(n+1,n+1)}{n+1}\\
&amp;=\sum_{n\ge 0}\, \frac{(-1)^{n}\, a^{n+1} \Gamma\left(n+1\right)\Gamma\left(n+1\right)}{(n+1)\,\Gamma\left(2\, n+1\right)}\\
&amp;=\sum_{n\ge 0}\, \frac{(-1)^{n}\, a^{n+1} \, n!^2}{(n+1)\,(2\, n+1)\, (2n)!}\\
&amp;=\sum_{n\ge 0}\, \frac{(-1)^{n}\, a^{n+1}}{(n+1)\,(2\, n+1)\, \binom{2n}{n}}
\end{align*}
</div>
<p>Therefore, we have the following sum!</p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{n\ge 0}\, \frac{(-1)^{n}\, a^{n+1}}{(n+1)\,(2\, n+1)\, \binom{2n}{n}}=\log\left( \frac{a+2 -\sqrt{a^{2} + 4 \, a}}{2}\right)^{2}
\end{equation*}
</div>
<p>This has got real values for <span class="math">\(a&gt;-4\)</span></p>
<p>E.g. when <span class="math">\(a=-2\)</span></p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{n\ge 0}\, \frac{2^{n+1}}{(n+1)\,(2\, n+1)\, \binom{2n}{n}}=\frac{\pi^2}{4}
\end{equation*}
</div>
<p>and when <span class="math">\(a=1/2\)</span></p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{n\ge 0}\, \frac{(-1)^{n}}{(n+1)\,(2\, n+1)\, \binom{2n}{n}\, 2^{n+1}}=\log\left(2\right)^{2}
\end{equation*}
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/a-restricted-arrangement-of-letters-in-a-word/" class="u-url">A restricted arrangement of letters in a word</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/a-restricted-arrangement-of-letters-in-a-word/" rel="bookmark"><time class="published dt-published" datetime="2014-04-05T13:25:01+05:30" title="2014-04-05 13:25">2014-04-05 13:25</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p><em>Find number of ways to arrange letters in word "benzine" such that no two same letters are adjacent to each other</em></p>
<p>This is quite a tough nut to crack. But, there are multiple ways to solve this: by summation, generating function, a recurrence and by integration; summation being the most efficient one.</p>
<div class="section" id="by-summation">
<h2>1 By summation</h2>
<p>We'll start with a generalized formula for 5 distinct objects, each with <span class="math">\(n_i\)</span> repetitions. The summation formula can be written as:</p>
<div class="math">
\begin{equation*}
\displaystyle N(n_1,n_2,n_3,n_4,n_5)=\sum_{x_{1}=1}^{n_{1}}\sum_{x_{2}=1}^{n_{2}}\sum_{x_{3}=1}^{n_{3}}\sum_{x_{4}=1}^{n_{4}}\sum_{x_{5}=1}^{n_{5}}\, (-1)^{n_{1}+n_{2}+n_{3}+n_{4}+n_{5}-x_{1}-x_{2}-x_{3}-x_{4}-x_{5}}\, \dfrac{(x_{1}+x_{2}+x_{3}+x_{4}+x_{5})!}{x_1!x_2!x_3!x_4!x_5!} \cdot \dbinom{n_{1}-1}{x_{1}-1}\,\dbinom{n_{2}-1}{x_{2}-1}\,\dbinom{n_{3}-1}{x_{3}-1}\,\dbinom{n_{4}-1}{x_{4}-1}\,\dbinom{n_{5}-1}{x_{5}-1}
\end{equation*}
</div>
<p>and for our problem, we need to find <span class="math">\(N(2,2,1,1,1)\)</span>. Putting that in Sage:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_cc881f4b7ecd4d8c84b62408f2e5f950-0">0</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_cc881f4b7ecd4d8c84b62408f2e5f950-1">1</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_cc881f4b7ecd4d8c84b62408f2e5f950-2">2</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_cc881f4b7ecd4d8c84b62408f2e5f950-0"></a><span class="n">var</span><span class="p">(</span><span class="s1">'x1 x2 x3 x4 x5'</span><span class="p">)</span>
<a name="rest_code_cc881f4b7ecd4d8c84b62408f2e5f950-1"></a><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span><span class="p">,</span><span class="n">n4</span><span class="p">,</span><span class="n">n5</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<a name="rest_code_cc881f4b7ecd4d8c84b62408f2e5f950-2"></a><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">n1</span><span class="o">+</span><span class="n">n2</span><span class="o">+</span><span class="n">n3</span><span class="o">+</span><span class="n">n4</span><span class="o">+</span><span class="n">n5</span><span class="o">-</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="o">-</span><span class="n">x3</span><span class="o">-</span><span class="n">x4</span><span class="o">-</span><span class="n">x5</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="o">+</span><span class="n">x5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">x4</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">x5</span><span class="p">))</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">n4</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">n5</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x5</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">x1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n1</span><span class="p">),</span><span class="n">x2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n2</span><span class="p">),</span><span class="n">x3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n3</span><span class="p">),</span><span class="n">x4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n4</span><span class="p">),</span><span class="n">x5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n5</span><span class="p">)</span>
</pre></td>
</tr></table>
<p><span class="math">\(=660\)</span></p>
</div>
<div class="section" id="generating-function">
<h2>2 Generating function</h2>
<p>This is actually just a part of the generating function (which I think can be derived from the recurrence relation)</p>
<div class="math">
\begin{equation*}
\displaystyle G_n(v,w,x,y,z)=\left(\begin{array}{rrrrr} v &amp; w &amp; x &amp; y &amp; z \end{array}\right)\cdot \left(\begin{array}{rrrrr} 0 &amp; w &amp; x &amp; y &amp; z \\ v &amp; 0 &amp; x &amp; y &amp; z \\ v &amp; w &amp; 0 &amp; y &amp; z \\ v &amp; w &amp; x &amp; 0 &amp; z \\ v &amp; w &amp; x &amp; y &amp; 0 \end{array}\right)^{n-1}\cdot \left(\begin{array}{r} 1 \\ 1 \\ 1 \\ 1 \\ 1 \end{array}\right)
\end{equation*}
</div>
<p>The coefficient of <span class="math">\(v^2 w^2 x y z\)</span> is the answer (evidently 660).</p>
<p>In Sage:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_0224099779fb42ba809bb8a965ec64a8-0">0</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_0224099779fb42ba809bb8a965ec64a8-1">1</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_0224099779fb42ba809bb8a965ec64a8-2">2</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_0224099779fb42ba809bb8a965ec64a8-3">3</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_0224099779fb42ba809bb8a965ec64a8-4">4</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_0224099779fb42ba809bb8a965ec64a8-5">5</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_0224099779fb42ba809bb8a965ec64a8-0"></a><span class="n">var</span><span class="p">(</span><span class="s1">'v w x y z'</span><span class="p">)</span>
<a name="rest_code_0224099779fb42ba809bb8a965ec64a8-1"></a><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
<a name="rest_code_0224099779fb42ba809bb8a965ec64a8-2"></a><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<a name="rest_code_0224099779fb42ba809bb8a965ec64a8-3"></a><span class="n">ones</span> <span class="o">=</span> <span class="n">ones_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_0224099779fb42ba809bb8a965ec64a8-4"></a><span class="n">fxt</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">A</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">ones</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_0224099779fb42ba809bb8a965ec64a8-5"></a><span class="n">fxt</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></td>
</tr></table>
</div>
<div class="section" id="by-recurrence">
<h2>3 By recurrence</h2>
<div class="math">
\begin{equation*}
\displaystyle f_{p,q,r,s,t}=\left\{\begin{matrix} 0 &amp; \text{if any of }p,q,r,s,t&lt;0\\ 1 &amp; \text{if any one of }p,q,r,s,t = 1 \text{ and others } 0\\ 2 &amp; \text{if any two of }p,q,r,s,t = 1 \text{ and others } 0\\ 6 &amp; \text{if any three of }p,q,r,s,t = 1 \text{ and the other's } 0\\ 24 &amp; \text{if any four of }p,q,r,s,t = 1 \text{ and the other } 0\\ 120 &amp; \text{if all of }p,q,r,s,t = 1 \\ A &amp; \text{otherwise} \end{matrix}\right.
\end{equation*}
</div>
<p>where</p>
<div class="math">
\begin{align*}
\displaystyle A=f_{p-1,q-1,r,s,t} + f_{p-1,q,r-1,s,t} + f_{p-1,q,r,s-1,t} + f_{p-1,q,r,s,t-1} + f_{p,q-1,r-1,s,t}+\\ f_{p,q-1,r,s-1,t} + f_{p,q-1,r,s,t-1} + f_{p,q,r-1,s-1,t} + f_{p,q,r-1,s,t-1} + f_{p,q,r,s-1,t-1}+\\ 2\cdot (f_{p-1,q-1,r-1,s,t} + f_{p-1,q-1,r,s-1,t} + f_{p-1,q-1,r,s,t-1} + f_{p-1,q,r-1,s-1,t}+ f_{p-1,q,r-1,s,t-1}+\\ f_{p-1,q,r,s-1,t-1} + f_{p,q-1,r-1,s-1,t} + f_{p,q-1,r-1,s,t-1} + f_{p,q-1,r,s-1,t-1} + f_{p,q,r-1,s-1,t-1})+\\ 3\cdot (f_{p-1,q-1,r-1,s-1,t} + f_{p-1,q-1,r-1,s,t-1} + f_{p-1,q-1,r,s-1,t-1} + f_{p-1,q,r-1,s-1,t-1} + f_{p,q-1,r-1,s-1,t-1})+4\cdot f_{p-1,q-1,r-1,s-1,t-1}
\end{align*}
</div>
<p>In Sage (python will also do), to print out the number of arrangements and its probability of occuring:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-0"> 0</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-1"> 1</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-2"> 2</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-3"> 3</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-4"> 4</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-5"> 5</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-6"> 6</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-7"> 7</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-8"> 8</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-9"> 9</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-10">10</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-11">11</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-12">12</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-13">13</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-14">14</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-15">15</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-16">16</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a8a1912047044055b5c19f1ed4886e67-17">17</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_a8a1912047044055b5c19f1ed4886e67-0"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-1"></a><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-2"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-3"></a>        <span class="k">return</span> <span class="mi">0</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-4"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">5</span><span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-5"></a>        <span class="k">return</span> <span class="mi">120</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-6"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">4</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-7"></a>        <span class="k">return</span> <span class="mi">24</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-8"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">3</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-9"></a>        <span class="k">return</span> <span class="mi">6</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-10"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">2</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-11"></a>        <span class="k">return</span> <span class="mi">2</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-12"></a>    <span class="k">if</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">]))</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-13"></a>        <span class="k">return</span> <span class="mi">1</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-14"></a>    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-15"></a><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a5</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-16"></a><span class="n">tot</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a5</span><span class="p">)</span>
<a name="rest_code_a8a1912047044055b5c19f1ed4886e67-17"></a><span class="k">print</span> <span class="n">tot</span><span class="p">,</span> <span class="n">tot</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">a2</span><span class="o">+</span><span class="n">a3</span><span class="o">+</span><span class="n">a4</span><span class="o">+</span><span class="n">a5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">a4</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">a5</span><span class="p">)))</span>
</pre></td>
</tr></table>
<p>NumPy is used here, since it allows array to be manipulated just like in an array programming language like J. The condition checking is made much shorter.</p>
<p>The recurrence is too slow if used for higher values. This can be sped up by caching the computed values, e.g. by dynamic programming.</p>
<p>We may back up our analytical results with a simulation (always a good thing to do, when possible)</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_2039f39679374acc911ed8ecefa8eebb-0">0</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_2039f39679374acc911ed8ecefa8eebb-1">1</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_2039f39679374acc911ed8ecefa8eebb-2">2</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_2039f39679374acc911ed8ecefa8eebb-0"></a>a=.1 1 2 2 3 4 5
<a name="rest_code_2039f39679374acc911ed8ecefa8eebb-1"></a>sim=: 3 : '0=+/0=2-/\(7?7){a'
<a name="rest_code_2039f39679374acc911ed8ecefa8eebb-2"></a>(+/%#)(sim"0)1000000#0
</pre></td>
</tr></table>
<p>about <span class="math">\(0.523729\)</span>, which is close to the actual result <span class="math">\(0.523809523809524\)</span>.</p>
</div>
<div class="section" id="using-integrals">
<h2>4 Using Integrals</h2>
<p>One more way is to make use of integrals, which actually conveys the summation in a compact representation.</p>
<div class="math">
\begin{equation*}
\displaystyle N(\{n_i\})=\int_0^\infty \prod_i q_{n_i}(x)\, e^{-x} \, dx
\end{equation*}
</div>
<p>where</p>
<div class="math">
\begin{equation*}
\displaystyle q_{n_i}(x) = \sum_{i=1}^{n_i} \frac{(-1)^{i-n_i}}{i!} {n_i-1 \choose i-1}x^i \text{ for }n_i\geq 1
\end{equation*}
</div>
<p><span class="math">\(n_i\)</span> is the number of repetitions of each character in the set.</p>
<p>For our example, the list of <span class="math">\(n_i\)</span> can be written as [2,2,1,1,1]</p>
<p>Hence, in Sage:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a44a88d2b55046eba0183827d8dc451f-0">0</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a44a88d2b55046eba0183827d8dc451f-1">1</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a44a88d2b55046eba0183827d8dc451f-2">2</a>
<a href="posts/a-restricted-arrangement-of-letters-in-a-word/#rest_code_a44a88d2b55046eba0183827d8dc451f-3">3</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_a44a88d2b55046eba0183827d8dc451f-0"></a><span class="n">var</span><span class="p">(</span><span class="s1">'i'</span><span class="p">)</span>
<a name="rest_code_a44a88d2b55046eba0183827d8dc451f-1"></a><span class="k">def</span> <span class="nf">q</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">SR</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="rest_code_a44a88d2b55046eba0183827d8dc451f-2"></a><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_a44a88d2b55046eba0183827d8dc451f-3"></a><span class="n">integrate</span><span class="p">(</span><span class="n">prod</span><span class="p">([</span><span class="n">q</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">])</span><span class="o">*</span><span class="n">e</span><span class="o">^-</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>which displays our expected answer.</p>
<p>References:</p>
<p><a class="reference external" href="https://brilliant.org/discussions/thread/permutation-problemneed-some-experts/">1. Brilliant.org discussion</a></p>
<p><a class="reference external" href="https://math.stackexchange.com/questions/76213/how-many-arrangements-of-a-2b-3c-4d-5e-have-no-identical-consecutive-lett">2. Stackexchange question</a></p>
<p><a class="reference external" href="https://math.stackexchange.com/questions/129451/find-the-number-of-arrangements-of-k-mbox-1s-k-mbox-2s-cdots">3. Another stackexchange question</a></p>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/generalized-derangements/" class="u-url">Generalized Derangements</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/generalized-derangements/" rel="bookmark"><time class="published dt-published" datetime="2014-04-04T21:03:19+05:30" title="2014-04-04 21:03">2014-04-04 21:03</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>Derangement problems are quite easy to do when there are no restrictions.
Suppose we want to extend the problem with restrictions, e.g.:</p>
<p><em>There are bins numbered 1,2,3,4,1,2,3,4,1,2 , and there are balls numbered 1,2,3,4,5,1,2,3,4,5 (distinguishable, say, two sets with different colors), and each bin is to contain a single ball such that the number of the bin and the ball should not match. In how many ways can that be done? (or what is the probability of that happening?)</em></p>
<p>This can be solved by using Rook polynomials.</p>
<p>The rook polynomial for a <span class="math">\(m\times n\)</span> rectangle is:</p>
<div class="math">
\begin{equation*}
\displaystyle r_{m,n}(x)=\sum_{k=0}^n{m\choose k}\, {n!\over (n-k)!}\, x^k
\end{equation*}
</div>
<p>For this problem:</p>
<p><span class="math">\(m=\)</span> number of bins numbered 's'</p>
<p><span class="math">\(n=\)</span> number of balls numbered 's'</p>
<p>and the rook polynomial we require to solve our problem is:</p>
<div class="math">
\begin{align*}
\displaystyle R(x)&amp;=r_{3,2}(x)\, r_{3,2}(x)\, r_{2,2}(x)\, r_{2,2}(x)\\\\
R(x)&amp;=(6\, x^2 + 6\, x + 1)^2\, (2\, x^2 + 4\, x + 1)^2
\end{align*}
</div>
<p>Now, with this rook polynomial, the number of ways of derangements can be found in two ways:</p>
<div class="math">
\begin{equation*}
\displaystyle \int_0^\infty \, x^n\, R\left(-\dfrac{1}{x}\right)\, e^{-x}\, dx
\end{equation*}
</div>
<p>where <span class="math">\(n\)</span> is the number of bins.</p>
<p>Another way is to expand <span class="math">\(R(x)\)</span> and replace each <span class="math">\(x^i\)</span> with <span class="math">\(i\cdot (n-i)!\)</span></p>
<p>The answer divided by <span class="math">\(n!\)</span> gives the probability.</p>
<p>Both ways are described in the following Sage code:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-0"> 0</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-1"> 1</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-2"> 2</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-3"> 3</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-4"> 4</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-5"> 5</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-6"> 6</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-7"> 7</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-8"> 8</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-9"> 9</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-10">10</a>
<a href="posts/generalized-derangements/#rest_code_c83e400bdab946379f17d00bab5ea339-11">11</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_c83e400bdab946379f17d00bab5ea339-0"></a><span class="n">var</span><span class="p">(</span><span class="s1">'k'</span><span class="p">)</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-1"></a><span class="k">def</span> <span class="nf">rp</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">SR</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-2"></a><span class="n">summ</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-3"></a><span class="n">balls</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-4"></a><span class="n">bins</span> <span class="o">=</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">balls</span><span class="p">)]</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-5"></a><span class="n">stbin</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-6"></a><span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">bins</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stbin</span><span class="p">]</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-7"></a><span class="n">rook</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">prod</span><span class="p">([</span><span class="n">rp</span><span class="p">(</span><span class="n">bins</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">balls</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stbin</span><span class="p">]))</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-8"></a><span class="n">nn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-9"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nn</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-10"></a>    <span class="n">summ</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">i</span><span class="o">*</span><span class="n">rook</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">nn</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<a name="rest_code_c83e400bdab946379f17d00bab5ea339-11"></a><span class="k">print</span> <span class="n">summ</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">nn</span><span class="p">),</span><span class="s2">"="</span><span class="p">,</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">nn</span><span class="o">*</span><span class="n">rook</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">oo</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">nn</span><span class="p">),</span><span class="s2">"~"</span><span class="p">,</span><span class="n">N</span><span class="p">(</span><span class="n">summ</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">nn</span><span class="p">)),</span><span class="n">summ</span>
</pre></td>
</tr></table>
<p><tt class="docutils literal">283/2520 = 283/2520 ~ 0.112301587301587 407520</tt></p>
<p>which agrees with a simulation:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/generalized-derangements/#rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-0">0</a>
<a href="posts/generalized-derangements/#rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-1">1</a>
<a href="posts/generalized-derangements/#rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-2">2</a>
<a href="posts/generalized-derangements/#rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-3">3</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-0"></a>lst=.10$1 2 3 4
<a name="rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-1"></a>a=.2#1+i.5
<a name="rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-2"></a>sim=: 3 : '0=+/((10?10){a)=lst'
<a name="rest_code_b3fd7a9fe85d4755a4ae0ed26c163ce7-3"></a>(+/%#)(sim"0)1000000#0
</pre></td>
</tr></table>
<p>which is about <span class="math">\(0.112101\)</span></p>
<p>If we now turn our attention to the classic derangement problem, e.g. 10 bins and balls, each numbered 1 to 10, we change the variables accordingly:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/generalized-derangements/#rest_code_f45d066736a24f639cdc0678590e02c1-0">0</a>
<a href="posts/generalized-derangements/#rest_code_f45d066736a24f639cdc0678590e02c1-1">1</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_f45d066736a24f639cdc0678590e02c1-0"></a><span class="n">balls</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<a name="rest_code_f45d066736a24f639cdc0678590e02c1-1"></a><span class="n">bins</span> <span class="o">=</span> <span class="n">balls</span>
</pre></td>
</tr></table>
<p>We see that the summ is indeed <span class="math">\(1334961\)</span>, which is the number of derangements, <span class="math">\(D(10)\)</span>.</p>
<p>References:</p>
<p><a class="reference external" href="https://math.stackexchange.com/questions/414023/probability-of-winning-the-game-1-2-3">1. Stackexchange problem</a></p>
<p><a class="reference external" href="http://www.cs.uleth.ca/~holzmann/notes/rook.pdf">2. Notes on rook polynomial</a></p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/monte-carlo-simulations-in-j/" class="u-url">Monte-Carlo simulations in J</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/monte-carlo-simulations-in-j/" rel="bookmark"><time class="published dt-published" datetime="2014-03-29T12:16:24+05:30" title="2014-03-29 12:16">2014-03-29 12:16</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>We will see some more problems on probability, and how to do it in J.</p>
<div class="section" id="derangement-problem">
<h2>1 Derangement problem</h2>
<p><em>There are 30 boxes numbered 1 to 30, and 30 balls numbered 1 to 30. If the balls are put into the boxes (one in each) randomly, what's the probability that none of the balls are put in the boxes with matching number?</em></p>
<p>By simulation:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_b5041f06a7f34ac0bdac4ab18d9b8101-0">0</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_b5041f06a7f34ac0bdac4ab18d9b8101-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_b5041f06a7f34ac0bdac4ab18d9b8101-0"></a>sim=: 3 : '0=+/(i.30)=30?30'
<a name="rest_code_b5041f06a7f34ac0bdac4ab18d9b8101-1"></a>(+/%#)(sim"0)100000#0
</pre></td>
</tr></table>
<p>The analytical answer:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_1c5a6ff9baf54a84a79421eae25a40c5-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_1c5a6ff9baf54a84a79421eae25a40c5-0"></a>+/((30$(1 _1))*(%!i.30))
</pre></td>
</tr></table>
</div>
<div class="section" id="urns-balls-and-a-gamble">
<h2>2 Urns, balls and a gamble.</h2>
<p>A game is played with the following rules: There is an urn with 20 balls, 10 red and 10 white. You need pick 10 balls out of these 20.</p>
<ol class="arabic simple">
<li>If 10 balls are of the same color, you get $300</li>
<li>If 9 balls are of the same color, you get $30</li>
<li>If 8 balls are of the same color, you get $3</li>
<li>If 7 balls are of the same color, you get $2</li>
<li>If 6 balls are of the same color, you get $1</li>
<li>If 5 balls are of the same color, you lose $5</li>
</ol>
<p>What's your expected amount?</p>
<p>Simulation answer:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_88f4c708e2c24f369a2df24ff85636a4-0">0</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_88f4c708e2c24f369a2df24ff85636a4-1">1</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_88f4c708e2c24f369a2df24ff85636a4-2">2</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_88f4c708e2c24f369a2df24ff85636a4-0"></a>a=: 10#0 1
<a name="rest_code_88f4c708e2c24f369a2df24ff85636a4-1"></a>sim=: 3 : '((_5 * 5 = ]) + ([: +/ 4 6 =/ ]) + (2 * [: +/ 3 7 =/ ]) + (3 * [: +/ 2 8 =/ ]) + (30 * [: +/ 1 9 =/ ]) + 300 * [: +/ 10 0 =/ ])+/(10?20){a'
<a name="rest_code_88f4c708e2c24f369a2df24ff85636a4-2"></a>(+/%#)(sim"0)1000000#0  NB. = _0.826702
</pre></td>
</tr></table>
<p>Analytical answer (hypergeometric distribution):</p>
<p><span class="math">\(A=\{1, 2, 3, 30, 300, -5\}\)</span></p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{i=0}^{4}\dfrac{A_i\cdot 2\, \dbinom{10}{i}\dbinom{10}{10-i}}{\dbinom{20}{10}}+\dfrac{A_5\cdot \dbinom{10}{5}^2}{\dbinom{20}{10}} =-\dfrac{76485}{92378}=-0.827956872848514
\end{equation*}
</div>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_fc57463b0719447a968a8dde9221d447-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_fc57463b0719447a968a8dde9221d447-0"></a>_5 1 2 3 30 300)*(((5!10)^2), (2 * (10 !~ ]) * 10 !~ 10 - ]) 6+i.5)%10!20
</pre></td>
</tr></table>
</div>
<div class="section" id="birthday-problem">
<h2>3 Birthday problem</h2>
<p>How many people should be in a room such that the probability of at least two of them sharing the same birthday is more than 0.5? (Assume 365 days in an year)</p>
<p>By Simulation:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_86e1891980bf46c391a68dce212bfd17-0">0</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_86e1891980bf46c391a68dce212bfd17-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_86e1891980bf46c391a68dce212bfd17-0"></a>sim=: 3 : '23&gt;+/~:?23#365'
<a name="rest_code_86e1891980bf46c391a68dce212bfd17-1"></a>(+/%#)(sim"0)100000#0
</pre></td>
</tr></table>
<p>Analytically:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_12d1370d54844ed8ac72016509c21b98-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_12d1370d54844ed8ac72016509c21b98-0"></a>1-*/((365-i.23)%(365)) NB. = 0.507297234323985
</pre></td>
</tr></table>
<p>To see a plot of the probabilities, up to 100 people in a room:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_374f44673e0147f98f584cdfb20004cc-0">0</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_374f44673e0147f98f584cdfb20004cc-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_374f44673e0147f98f584cdfb20004cc-0"></a>load'plot'
<a name="rest_code_374f44673e0147f98f584cdfb20004cc-1"></a>'marker' plot (1+i.100);((1 - [: */ 365 %~ 365 - i.)"0) 1+i.100
</pre></td>
</tr></table>
</div>
<div class="section" id="dice">
<h2>4 4 dice</h2>
<p>Four dice are rolled, what's the probability that no two faces are repeated? (E.g. 6 4 2 5 is okay, but 3 6 5 6 is forbidden)</p>
<p>By simulation:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_b9b022780f674ddba110219c122a4724-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_b9b022780f674ddba110219c122a4724-0"></a>sim=: 3 : '(4 = [: +/ [: +/ =/~)?4#6'
</pre></td>
</tr></table>
<p>By permutation:</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}=\dfrac{\dbinom{6}{4}\cdot 4!}{6^4} = \dfrac{5}{18} = 0.2777777
\end{equation*}
</div>
<p>Putting that in J console:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_785cc64953d24ea6b2bec267f6752474-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_785cc64953d24ea6b2bec267f6752474-0"></a>((4!6)*!4)%6^4
</pre></td>
</tr></table>
<p>By counting:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_27461e2ed6544a44907f73c9e62bf6d9-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_27461e2ed6544a44907f73c9e62bf6d9-0"></a>(+/4=+/"1~:"1(6 6 6 6#:i.1296))%6^4 NB. this uses base-6 representation till 6^4
</pre></td>
</tr></table>
</div>
<div class="section" id="the-ballot-problem">
<h2>5 The ballot problem</h2>
<p>In an election, candidate A receives n votes, and candidate B receives m votes where <span class="math">\(n &gt; m\)</span>. Assuming that all orderings are equally likely, show that the probability that A is always ahead in the count of votes is <span class="math">\(\dfrac{n - m}{n + m}\)</span>.</p>
<p>Here's a simulation to see that it may be true:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_543ea413cb7547f5840dbcc29721c83c-0">0</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_543ea413cb7547f5840dbcc29721c83c-1">1</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_543ea413cb7547f5840dbcc29721c83c-2">2</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_543ea413cb7547f5840dbcc29721c83c-3">3</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_543ea413cb7547f5840dbcc29721c83c-4">4</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_543ea413cb7547f5840dbcc29721c83c-0"></a>n=:55
<a name="rest_code_543ea413cb7547f5840dbcc29721c83c-1"></a>m=:45
<a name="rest_code_543ea413cb7547f5840dbcc29721c83c-2"></a>a=:(m#_1),n#1
<a name="rest_code_543ea413cb7547f5840dbcc29721c83c-3"></a>sim=: 3 : '100=+/0&lt;+/\(100?100){a'
<a name="rest_code_543ea413cb7547f5840dbcc29721c83c-4"></a>(+/%#)(sim"0)100000#0 NB. = 0.0993
</pre></td>
</tr></table>
<p>which is close to 0.1 computed from the formula.</p>
</div>
<div class="section" id="an-ace-from-a-regular-deck-of-52-cards">
<h2>6 An ace from a regular deck of 52 cards</h2>
<p>A deck of cards is well shuffled, and placed face down on a table. The cards are picked one after another, what's the probability that you get to see the first ace when <span class="math">\(k^{th}\)</span> card is picked?</p>
<p>Finding the answer is quite easy, which is</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}(k)=\dfrac{\dbinom{48}{k-1}}{\dbinom{52}{k-1}}\cdot \dfrac{4}{52-k}
\end{equation*}
</div>
<p>and a simulation can back up our claim, e.g. for <span class="math">\(k=5\)</span>:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_a1495b6631c444979d0ee63cfc28101b-0">0</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_a1495b6631c444979d0ee63cfc28101b-1">1</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_a1495b6631c444979d0ee63cfc28101b-2">2</a>
<a href="posts/monte-carlo-simulations-in-j/#rest_code_a1495b6631c444979d0ee63cfc28101b-3">3</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_a1495b6631c444979d0ee63cfc28101b-0"></a>pos=: 5
<a name="rest_code_a1495b6631c444979d0ee63cfc28101b-1"></a>a=:(4#1),48#0
<a name="rest_code_a1495b6631c444979d0ee63cfc28101b-2"></a>sim=: 3 : 'pos=1+{.I.(52?52){a'
<a name="rest_code_a1495b6631c444979d0ee63cfc28101b-3"></a>(+/%#)(sim"0)100000#0
</pre></td>
</tr></table>
<p>and the probabilities for first five positions:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulations-in-j/#rest_code_a098d09c205e4bcd8eb39b764af2f775-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_a098d09c205e4bcd8eb39b764af2f775-0"></a>(((48 !~ 1 -~ ]) % 52 !~ 1 -~ ]) * 4 % 52 - 1 -~ ]) 1+i.5
</pre></td>
</tr></table>
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-5.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-3.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script>
</div>
        <!--End of body content-->

        <footer id="footer"></footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
