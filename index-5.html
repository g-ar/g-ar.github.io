<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Some random stuffs -- Programming and Mathematics">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gopinath A R (old posts, page 5) | Gopinath A R</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://g-ar.github.io/index-5.html">
<link rel="prev" href="index-6.html" type="text/html">
<link rel="next" href="index-4.html" type="text/html">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://g-ar.github.io/">

                <span id="blog-title">Gopinath A R</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>
                </li>
<li>
<a href="stories/about-me/">About</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/using-directed-graphs-to-form-multivariate-recurrence-relations/" class="u-url">Using Directed Graphs to form multivariate recurrence relations</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/using-directed-graphs-to-form-multivariate-recurrence-relations/" rel="bookmark"><time class="published dt-published" datetime="2014-07-26T16:26:48+05:30" title="2014-07-26 16:26">2014-07-26 16:26</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>There are items comprising of red cubes, blue cubes, and balls;
how many ways can 3 red cubes, 4 blue cubes and 8 balls be arranged in a line so that:</p>
<ul class="simple">
<li>No three cubes are consecutive</li>
<li>No three balls are consecutive</li>
<li>No two red cubes are next to one another</li>
<li>No two blue cubes are next to one another</li>
</ul>
<p>How do we go about finding a general formula for <span class="math">\(r\)</span> red cubes, <span class="math">\(b\)</span> blue cubes and <span class="math">\(c\)</span> balls ?</p>
<p>The answer lies in forming a directed graph / Finite Automaton, as we have seen it in one of the previous posts.</p>
<p>Instead of filling in the number of ways, we use the variable names as weights for the valid transitions.</p>
<p>Hence, we can directly solve for the general case by using the following adjacency matrix:</p>
<div class="math">
\begin{equation*}
\displaystyle \begin{array}{|l|rrrrrr|}\hline &amp; \mathrm{I} &amp; \mathrm{R} &amp; \mathrm{B} &amp; \mathrm{C} &amp; \mathrm{BR} &amp; \mathrm{CC} \\ \hline \mathrm{I} &amp; 0 &amp; r &amp; b &amp; c &amp; 0 &amp; 0 \\ \mathrm{R} &amp; 0 &amp; 0 &amp; 0 &amp; c &amp; b &amp; 0 \\ \mathrm{B} &amp; 0 &amp; 0 &amp; 0 &amp; c &amp; r &amp; 0 \\ \mathrm{C} &amp; 0 &amp; r &amp; b &amp; 0 &amp; 0 &amp; c \\ \mathrm{BR} &amp; 0 &amp; 0 &amp; 0 &amp; c &amp; 0 &amp; 0 \\ \mathrm{CC} &amp; 0 &amp; r &amp; b &amp; 0 &amp; 0 &amp; 0 \\ \hline \end{array}
\end{equation*}
</div>
<p>which is for the constraints that there's no <span class="math">\(RR, BB, RBR, BRB\)</span> or <span class="math">\(CCC\)</span>.</p>
<p>Therefore, for 15 items, we compute</p>
<div class="math">
\begin{equation*}
\displaystyle \left(\begin{array}{rrrrrr} 0 &amp; r &amp; b &amp; c &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; c &amp; b &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; c &amp; r &amp; 0 \\ 0 &amp; r &amp; b &amp; 0 &amp; 0 &amp; c \\ 0 &amp; 0 &amp; 0 &amp; c &amp; 0 &amp; 0 \\ 0 &amp; r &amp; b &amp; 0 &amp; 0 &amp; 0 \end{array}\right)^{15}
\end{equation*}
</div>
<p>and extract <span class="math">\([c^8 b^4 r^3]\)</span> from the sum of the first row, which is <span class="math">\(11394\)</span>.</p>
<p>We may also compute the characteristic polynomial of the matrix to get the structure of its multivariate recurrence
relation:</p>
<div class="math">
\begin{equation*}
\displaystyle x^6 - (bc + cr)x^4 - (bc^2 + 2bcr + c^2r)x^3 - 2bc^2rx^2 = 0
\end{equation*}
</div>
<p>which is just like the characteristic equation of a recurrence relation, which is:</p>
<div class="math">
\begin{equation*}
\displaystyle f_{b,c,r} = f_{b-1,c-1,r}+f_{b,c-1,r-1}+f_{b-1,c-2,r}+f_{b,c-2,r-1}+2 \left(f_{b-1,c-1,r-1}+f_{b-1,c-2,r-1}\right)
\end{equation*}
</div>
<p>and set the required boundary conditions.</p>
<p>Computing the regular expression from the minimized DFA gives us the following multivariate generating function:</p>
<div class="math">
\begin{equation*}
\displaystyle G(r,b,c) = \frac{\left(1+c+c^2\right)\left(1+b+r+2br\right)}{1-c\left(1+c\right)\left(b+r+2br\right)}
\end{equation*}
</div>
<p>Reference:</p>
<p><a class="reference external" href="https://math.stackexchange.com/questions/866503/putting-objects-in-a-line">Putting objects in a line</a></p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/fricas-an-introduction/" class="u-url">FriCAS -- an introduction</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/fricas-an-introduction/" rel="bookmark"><time class="published dt-published" datetime="2014-06-18T15:35:29+05:30" title="2014-06-18 15:35">2014-06-18 15:35</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>There are quite a few different free computer algebra systems around <span class="math">\(-\)</span> Sage, maxima, sympy, FriCAS/Axiom etc. <span class="math">\(-\)</span> each having its strengths and lack of something. Having choices and access to source code are good, since we are not at mercy of vendors like those big M developers for bug fixes and feature additions (along with outrageous licence costs).</p>
<p>I have been using FriCAS for a while mainly for its number sequence guessing routines, an indispensable part when working on enumeration problems. But recently, when I tried other operations which I mostly do in Sage or maxima, like integration and solving equations, I was surprised to see it could give simpler and more complete answers than Sage/maxima.</p>
<p>One more good thing is that it comes with a fricas mode for emacs, which has many more features compared to running from a terminal. E.g. it gives features like auto-completion, matched-parenthesis highlighting, shortcut keys for navigating through the input, yanking text etc., and of course, we can define our own shortcuts since it's emacs! Let us see how to set FriCAS up and run from emacs in linux. The latest version at the time is 1.2.3, and I have only tried amd64 binary version.</p>
<p>Make a directory <tt class="docutils literal">$HOME/bin/</tt> if not already there, and add to the <tt class="docutils literal">$PATH</tt> environment variable. Extract the components to <tt class="docutils literal">$HOME/bin/</tt>. To run it, we need to modify a few paths in its files. Go to <tt class="docutils literal">$HOME/bin/usr/local/bin</tt>, in fricas file, update the variable <tt class="docutils literal">exec_prefix</tt> to</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_53beb0d6da5e4abe9afa30660e3192c0-0">0</a></pre></div></td>
<td class="code"><pre class="code sh"><a name="rest_code_53beb0d6da5e4abe9afa30660e3192c0-0"></a><span class="nv">exec_prefix</span><span class="o">=</span><span class="s2">"</span><span class="si">${</span><span class="nv">FRICAS_PREFIX</span><span class="k">:-</span><span class="p">/home/bin/usr/local</span><span class="si">}</span><span class="s2">"</span>
</pre></td>
</tr></table>
<p>In file efricas, update FRICASCMD to</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_f7ba6f4bcfee4c70a68f0e93f83835c3-0">0</a></pre></div></td>
<td class="code"><pre class="code sh"><a name="rest_code_f7ba6f4bcfee4c70a68f0e93f83835c3-0"></a><span class="nv">FRICASCMD</span><span class="o">=</span><span class="s1">'/home/bin/fricas'</span>
</pre></td>
</tr></table>
<p>and also update the line which calls emacs.</p>
<p>Update the function fricas <span class="math">\(-\)</span> run in <tt class="docutils literal">$HOME/bin/usr/local/lib/fricas/emacs/fricas.el</tt> to</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_10b545138a314c12a0ba36de23341f39-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_10b545138a314c12a0ba36de23341f39-1">1</a>
<a href="posts/fricas-an-introduction/#rest_code_10b545138a314c12a0ba36de23341f39-2">2</a>
<a href="posts/fricas-an-introduction/#rest_code_10b545138a314c12a0ba36de23341f39-3">3</a>
<a href="posts/fricas-an-introduction/#rest_code_10b545138a314c12a0ba36de23341f39-4">4</a>
<a href="posts/fricas-an-introduction/#rest_code_10b545138a314c12a0ba36de23341f39-5">5</a></pre></div></td>
<td class="code"><pre class="code scheme"><a name="rest_code_10b545138a314c12a0ba36de23341f39-0"></a><span class="p">(</span><span class="nf">defun</span> <span class="nv">fricas-run</span> <span class="p">()</span>
<a name="rest_code_10b545138a314c12a0ba36de23341f39-1"></a>  <span class="s">"Run FriCAS in the current BUFFER."</span>
<a name="rest_code_10b545138a314c12a0ba36de23341f39-2"></a>  <span class="p">(</span><span class="nf">message</span> <span class="s">"Starting FriCAS..."</span><span class="p">)</span>
<a name="rest_code_10b545138a314c12a0ba36de23341f39-3"></a>  <span class="p">(</span><span class="nf">start-process-shell-command</span> <span class="s">"fricas"</span> <span class="p">(</span><span class="nf">current-buffer</span><span class="p">)</span>
<a name="rest_code_10b545138a314c12a0ba36de23341f39-4"></a>                               <span class="nv">fricas-run-command</span>
<a name="rest_code_10b545138a314c12a0ba36de23341f39-5"></a>                               <span class="s">"-noclef"</span> <span class="s">"2&gt;/dev/null"</span><span class="p">))</span>
</pre></td>
</tr></table>
<p>Otherwise, FriCAS won't start within emacs.</p>
<p>Next, create two bash scripts within <tt class="docutils literal">$HOME/bin/</tt> with filenames "fricas" <span class="math">\(-\)</span> which is to execute <tt class="docutils literal">$HOME/bin/usr/local/bin/fricas</tt>, and "efricas" to execute <tt class="docutils literal">$HOME/bin/usr/local/bin/efricas</tt>. Make those two newly created files as executable. There, we are all set now. Simply open the terminal, and enter "efricas" to run fricas within emacs. If everything goes well, we will have fricas running within emacs.</p>
<p>Now, let us have a brief overview of its commands (some are examples taken from the axiom book),
and its advantages to other free CAS, and probably even the paid ones.</p>
<ol class="arabic">
<li>
<p class="first"><strong>INTEGRATION</strong></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_b198b359985c4f538de95baf465803ad-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_b198b359985c4f538de95baf465803ad-0"></a>integrate(tan(atan(x)/3),x)
</pre></td>
</tr></table>
<p>This integral is an example mentioned in their document, which is instantly solved by fricas, but Sage/maxima fails after trying for a long time.</p>
</li>
<li>
<div class="first"><table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_7730bec8495c4f118e20b75e1d526bdf-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_7730bec8495c4f118e20b75e1d526bdf-0"></a>integrate((x+a)^(1/2)/x,x)
</pre></td>
</tr></table></div>
<p>This gives two results, for negative and non-negative a.</p>
<p>Hence, besides having a good capability, another advantage over Sage and maxima is that we need not declare the symbols which will be used in operations. It also computes the results for all possible cases, and doesn't nag us to make assumptions like in the case of Sage/maxima. (sometimes it keeps asking for the same assumption even if we have already done so!)</p>
</li>
<li>
<p class="first"><strong>SOLVING EQUATIONS</strong></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_6dab55959e664f75802edfd434cea315-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_6dab55959e664f75802edfd434cea315-1">1</a>
<a href="posts/fricas-an-introduction/#rest_code_6dab55959e664f75802edfd434cea315-2">2</a>
<a href="posts/fricas-an-introduction/#rest_code_6dab55959e664f75802edfd434cea315-3">3</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_6dab55959e664f75802edfd434cea315-0"></a>solve(x^3+x+1,1/1000)
<a name="rest_code_6dab55959e664f75802edfd434cea315-1"></a>solve(x^3+x+1,1/1000.0)
<a name="rest_code_6dab55959e664f75802edfd434cea315-2"></a>radicalSolve(x^3+x+1)
<a name="rest_code_6dab55959e664f75802edfd434cea315-3"></a>complexSolve(x^3+x+1,1/1000.0)
</pre></td>
</tr></table>
<p>etc. All of the above call the same algorithm to compute the roots, but the result is returned depending on the data type.</p>
<p>It can also solve non-linear simultaneous equations.</p>
</li>
<li>
<div class="first"><table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_dcd9e29888e2411c99ac3fcb40ed9eb6-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_dcd9e29888e2411c99ac3fcb40ed9eb6-1">1</a>
<a href="posts/fricas-an-introduction/#rest_code_dcd9e29888e2411c99ac3fcb40ed9eb6-2">2</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_dcd9e29888e2411c99ac3fcb40ed9eb6-0"></a>solve([x+y^2-4,x^2+y-2],1.E-10)
<a name="rest_code_dcd9e29888e2411c99ac3fcb40ed9eb6-1"></a>solve([x+y^2-4,x^2+y-2],1/10^10)
<a name="rest_code_dcd9e29888e2411c99ac3fcb40ed9eb6-2"></a>radicalSolve([x+y^2-4,x^2+y-2])
</pre></td>
</tr></table></div>
<p>We can see that it can give all the exact results also effortlessly. In Sage/maxima, there is currently no way of making itto output all results in form of radicals.</p>
</li>
<li>
<p class="first"><strong>RECURRENCE RELATIONS</strong></p>
<p>The recursions are transformed into iterated code and compiled! And since it can also symbolically compute, this proves very useful to examine sequences.</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_ef28145e6e27406297250cd9268f7fdb-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_ef28145e6e27406297250cd9268f7fdb-1">1</a>
<a href="posts/fricas-an-introduction/#rest_code_ef28145e6e27406297250cd9268f7fdb-2">2</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_ef28145e6e27406297250cd9268f7fdb-0"></a>fib(0)==0
<a name="rest_code_ef28145e6e27406297250cd9268f7fdb-1"></a>fib(1)==1
<a name="rest_code_ef28145e6e27406297250cd9268f7fdb-2"></a>fib(n)==fib(n-1)+fib(n-2)
</pre></td>
</tr></table>
<p>This automatically compiles and computes the fibonacci numbers as an iterated code.</p>
</li>
<li>
<div class="first"><table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-1">1</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-2">2</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-3">3</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-4">4</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-5">5</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-6">6</a>
<a href="posts/fricas-an-introduction/#rest_code_f1ed69f805d24adfb99a04bac863f4d8-7">7</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-0"></a>a(0)==1
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-1"></a>a(1)==1
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-2"></a>a(2)==1
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-3"></a>b(0)==0
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-4"></a>b(1)==0
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-5"></a>b(2)==0
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-6"></a>a(n)==a(n-1)+b(n-1)
<a name="rest_code_f1ed69f805d24adfb99a04bac863f4d8-7"></a>b(n)==a(n-3)+b(n-3)
</pre></td>
</tr></table></div>
<p>This simultaneous recurrence is actually narayana's cows sequence, and this kind of recurrence is compiled as well!
Using this, we will make use of the guessing routines.</p>
</li>
<li>
<p class="first"><strong>GUESS</strong></p>
<p>The guessing routine in FriCAS can give us the likely generating function, recurrence relation, functional equation etc.</p>
<p>Using the above simultaneous recurrence, the generating function can be obtained as:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_cff9a618d09447a7aebb045e54dc1569-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_cff9a618d09447a7aebb045e54dc1569-0"></a>guessAlg [a(i)+b(i) for i in 0..20]
</pre></td>
</tr></table>
</li>
<li>
<p class="first">Try for the recurrence relation.</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_f873ff5b3580487facfaf3e3cafe791b-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_f873ff5b3580487facfaf3e3cafe791b-0"></a>guessPRec [a(i)+b(i) for i in 0..20]
</pre></td>
</tr></table>
<p>This command gives a single recurrence relation! Hence, we may solve a problem our way and use the guessing routines for simplification.
Series expansion</p>
<p>Working with series is also in a way different and easy.</p>
</li>
<li>
<div class="first"><table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_cdde01bcdd4a4a178d28866bde983f78-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_cdde01bcdd4a4a178d28866bde983f78-0"></a>series(x/(1-x-x^2),x=0)
</pre></td>
</tr></table></div>
<p>or like this</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_b52d5143ea2040d28744d96500a4e19b-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_b52d5143ea2040d28744d96500a4e19b-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_b52d5143ea2040d28744d96500a4e19b-0"></a>x:=series 'x
<a name="rest_code_b52d5143ea2040d28744d96500a4e19b-1"></a>x/(1-x-x^2)
</pre></td>
</tr></table>
</li>
<li>
<p class="first">If we require only the list of coefficients of the series</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_3e65717917c9495da72e614b918411c5-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_3e65717917c9495da72e614b918411c5-0"></a>cf:=coefficients x/(1-x-x^2)
</pre></td>
</tr></table>
<p>If we want the <span class="math">\([x^{100}]\)</span></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_e4ef0f0e98634daca208d8b25d5f4b33-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_e4ef0f0e98634daca208d8b25d5f4b33-0"></a>coefficient(x/(1-x-x^2),100)
</pre></td>
</tr></table>
<p>or</p>
<p><tt class="docutils literal">cf.200</tt></p>
</li>
<li>
<p class="first"><strong>SOME MISCELLANEOUS INFO</strong></p>
<p>Since the output is always pretty-printed and does not provide a way to turn it off (though there are options to output different formats like TeX, fortran, html etc.), we can obtain an unparsed output the following way:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_fc1accb33e9c4594a27cdb384acc4f27-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_fc1accb33e9c4594a27cdb384acc4f27-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_fc1accb33e9c4594a27cdb384acc4f27-0"></a>k:=(-b)^(1/3)/(1+b)
<a name="rest_code_fc1accb33e9c4594a27cdb384acc4f27-1"></a>unparse(k :: InputForm)
</pre></td>
</tr></table>
</li>
<li>
<p class="first">Shell commands can be executed within it:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_ba0756426ea94673b17b392819a04f90-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_ba0756426ea94673b17b392819a04f90-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_ba0756426ea94673b17b392819a04f90-0"></a>)system pwd
<a name="rest_code_ba0756426ea94673b17b392819a04f90-1"></a>)system date
</pre></td>
</tr></table>
<p>etc.</p>
</li>
<li>
<p class="first"><strong>CHANGE OUTPUT FORMAT</strong></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_7763a5ebde74442a99b7f0314a2d503b-0">0</a>
<a href="posts/fricas-an-introduction/#rest_code_7763a5ebde74442a99b7f0314a2d503b-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_7763a5ebde74442a99b7f0314a2d503b-0"></a>)set output tex on
<a name="rest_code_7763a5ebde74442a99b7f0314a2d503b-1"></a>)set output tex abc.tex
</pre></td>
</tr></table>
</li>
<li>
<p class="first"><strong>SHOW TIME FOR EXECUTION</strong></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_991dc78c7dd144d6839007454ce54b5c-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_991dc78c7dd144d6839007454ce54b5c-0"></a>)set messages time on
</pre></td>
</tr></table>
</li>
<li>
<p class="first">Sage provides an interface to FriCAS, so we may even run it within Sage.</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/fricas-an-introduction/#rest_code_0b68dcfa3c7240de8d6c213c783ffa19-0">0</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_0b68dcfa3c7240de8d6c213c783ffa19-0"></a>fricas('series(1/sqrt(1-x),x=0)')
</pre></td>
</tr></table>
</li>
</ol>
<p>and there are many more. It even has its own language <span class="math">\(-\)</span> SPAD.</p>
<p>For more details, see</p>
<p><a class="reference external" href="http://fricas.sourceforge.net/doc/book.pdf">1. Axiom book</a></p>
<p><a class="reference external" href="http://axiom-wiki.newsynthesis.org/SandBoxFriCAS">2. FriCAS sandbox</a></p>
<p>and of course, the source code is available to know "everything" about it!</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/" class="u-url">Probability of a sum being less than 1 (convolution of pdf)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/" rel="bookmark"><time class="published dt-published" datetime="2014-06-01T15:23:45+05:30" title="2014-06-01 15:23">2014-06-01 15:23</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>If we choose <span class="math">\(n\)</span> numbers randomly and uniformly from <span class="math">\([0,1]\)</span> and raise each number to <span class="math">\(k\)</span> <span class="math">\((k&gt;0)\)</span>, what is the probability that the sum will be less than 1?</p>
<p>i.e. what is</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}\left(\Big(\sum_{i=1}^n x_i^k\Big)&lt;1\right)\;\;\; , x_i\in \mathcal{U}\left(0,1\right)
\end{equation*}
</div>
<p>The answer can be derived by using convolution of probability density functions.</p>
<p>For two pdfs, <span class="math">\(f(x)\)</span> and <span class="math">\(g(y)\)</span>, the convolution <span class="math">\(f*g\)</span> is defined as</p>
<div class="math">
\begin{align*}
\displaystyle \left(f*g\right)(z) &amp;= \int_{-\infty}^{\infty} \, f(z-y)g(y)\, dy\\
&amp;= \int_{-\infty}^{\infty} \, g(z-x) f(x)\, dx
\end{align*}
</div>
<p>Let <span class="math">\(X_1\)</span> and <span class="math">\(X_2\)</span> be two random variables which represent <span class="math">\(x_1^{1/k}\)</span> and <span class="math">\(x_2^{1/k}\)</span>.</p>
<p>The pdf is then given by:</p>
<div class="math">
\begin{equation*}
\displaystyle f_{X_1}(x)=f_{X_2}(x)=\frac{d}{dx} (x^k)=k\, x^{k-1}
\end{equation*}
</div>
<p>and the pdf of the sum of two numbers <span class="math">\(f_2(z)\)</span> (in the region <span class="math">\(0\le z \le 1\)</span>) is:</p>
<div class="math">
\begin{align*}
\displaystyle f_2(z)&amp;= \int_{0}^{z} \, f_{X_1}(z-y) f_{X_2}(y) \, dy\\
&amp;= k^2\cdot z^{2\, k - 1}\cdot \mathrm{B}(k, k)
\end{align*}
</div>
<p>After this, we can iteratively continue for more terms:</p>
<div class="math">
\begin{align*}
\displaystyle f_3(z)&amp;= \int_{0}^{z} \, f_{X_1}(z-y) f_{2}(y) \, dy\\
&amp;= k^3\cdot z^{3\, k - 1}\cdot \mathrm{B}(2\, k, k)\cdot \mathrm{B}(k, k)
\end{align*}
</div>
<p>Continuing in that manner, for sum of <span class="math">\(n\)</span> terms, we will end up with:</p>
<div class="math">
\begin{equation*}
\displaystyle f_n(z) = k^n\cdot z^{n\, k - 1}\cdot \prod_{i=1}^{n-1} \mathrm{B}(i\, k, k)
\end{equation*}
</div>
<p>Since we require the probability of the sum to be less than one, we will evaluate that integral and write the beta functions in terms of gamma functions and simplify:</p>
<div class="math">
\begin{align*}
\displaystyle \mathbb{P}\left(\Big(\sum_{i=1}^n x_i^k\Big)&lt;1\right) &amp;= \int_{0}^{1} \, f_n(z)\, dz\\
&amp;= \frac{k^{n-1}}{n}\prod_{i=1}^{n-1} \mathrm{B}(i\, k, k) \\
&amp;= \frac{k^{n-1}\big(\Gamma(k)\big)^n}{n\, \Gamma(n\, k)} \\
&amp;= \frac{\big(\Gamma(k+1)\big)^n}{\Gamma(n\, k+1)}
\end{align*}
</div>
<p>That's some formula!</p>
<p>In Sage, it can be written as</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-0">0</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-1">1</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-2">2</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-3">3</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-4">4</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-5">5</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-6">6</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-7">7</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-8">8</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_1f8bb036cfe2484d9932f6af699d577c-9">9</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-0"></a><span class="n">var</span><span class="p">(</span><span class="s1">'k y z'</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-1"></a><span class="n">assume</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-2"></a><span class="n">assume</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-3"></a><span class="n">f1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="n">k</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-4"></a><span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-5"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-6"></a>    <span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">f1</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-7"></a>    <span class="k">print</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">f2</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-8"></a>
<a name="rest_code_1f8bb036cfe2484d9932f6af699d577c-9"></a><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">n</span><span class="o">/</span><span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>To verify our answer, we can perform a simulation:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_0af8bb27121148e5918a9b1ef5060535-0">0</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_0af8bb27121148e5918a9b1ef5060535-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_0af8bb27121148e5918a9b1ef5060535-0"></a>sim=: 3 : '1&gt;+/(?6#0)^6'
<a name="rest_code_0af8bb27121148e5918a9b1ef5060535-1"></a>(+/%#)(sim"0)100000#0 NB. = 0.63926
</pre></td>
</tr></table>
<p>If we want to perform a simulation in a more verbose language, R is a good candidate.</p>
<p>The code in R looks like:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_8b061d233b604463bdaf4fa82e5106cd-0">0</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_8b061d233b604463bdaf4fa82e5106cd-1">1</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_8b061d233b604463bdaf4fa82e5106cd-2">2</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_8b061d233b604463bdaf4fa82e5106cd-3">3</a></pre></div></td>
<td class="code"><pre class="code R"><a name="rest_code_8b061d233b604463bdaf4fa82e5106cd-0"></a>n <span class="o">=</span> <span class="m">6</span>
<a name="rest_code_8b061d233b604463bdaf4fa82e5106cd-1"></a>k <span class="o">=</span> <span class="m">6</span>
<a name="rest_code_8b061d233b604463bdaf4fa82e5106cd-2"></a>b <span class="o">=</span> <span class="kt">array</span><span class="p">(</span>runif<span class="p">(</span>n<span class="o">*</span><span class="m">1e6</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>dim<span class="o">=</span><span class="kt">c</span><span class="p">(</span>n<span class="p">,</span><span class="m">1e6</span><span class="p">))</span>
<a name="rest_code_8b061d233b604463bdaf4fa82e5106cd-3"></a><span class="kp">mean</span><span class="p">(</span><span class="kp">apply</span><span class="p">(</span>b<span class="o">^</span>k<span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="kp">sum</span><span class="p">)</span><span class="o">&lt;</span><span class="m">1</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>and if we want to perform using two dimensional arrays in J also, the equivalent code can be written as:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_3a1e195bc4904f5d83131dc4159b66a7-0">0</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_3a1e195bc4904f5d83131dc4159b66a7-1">1</a>
<a href="posts/probability-of-a-sum-being-less-than-1-convolution-of-pdf/#rest_code_3a1e195bc4904f5d83131dc4159b66a7-2">2</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_3a1e195bc4904f5d83131dc4159b66a7-0"></a>'n k'=: 6 6
<a name="rest_code_3a1e195bc4904f5d83131dc4159b66a7-1"></a>a=:(n, 1e6) $ ?(n*1e6)#0
<a name="rest_code_3a1e195bc4904f5d83131dc4159b66a7-2"></a>(+/%#)1&gt;+/a^k NB. = 0.637572
</pre></td>
</tr></table>
<p>The corresponding probability derived analytically is:</p>
<div class="math">
\begin{align*}
\displaystyle \mathbb{P}\left(\Big(\sum_{i=1}^6 x_i^6\Big)&lt;1\right) = f\left(6,\frac{1}{6}\right) \\ = \Gamma\left(\frac{7}{6}\right)^6 \approx 0.637528558759471
\end{align*}
</div>
<p>References:</p>
<p><a class="reference external" href="http://www.dartmouth.edu/~chance/teaching_aids/books_articles/probability_book/Chapter7.pdf">1. Dartmouth Probability Book</a></p>
<p><a class="reference external" href="http://arxiv.org/pdf/cs/0604056.pdf">2. An arxiv article</a></p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Volume_of_an_n-ball">3. Volume of a n-ball</a></p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/interesting-definite-integrals/" class="u-url">Interesting definite integrals</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/interesting-definite-integrals/" rel="bookmark"><time class="published dt-published" datetime="2014-05-04T15:16:30+05:30" title="2014-05-04 15:16">2014-05-04 15:16</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>We will see a list of few integrals which yields to differentiation under the integral sign:</p>
<ol class="arabic">
<li>
<div class="first math">
\begin{align*}
\displaystyle \int_0^\infty \, \frac{\arctan{(a\,(x^n))}}{x^{n}}\, dx = \frac{a^{1-\frac{1}{n}} {\rm B}\left(\frac{1}{2 \, n}, 1-\frac{1}{2 \, n}\right)}{2 \, {\left({n} - 1\right)}}\\ =\frac{\pi \, a^{1-\frac{1}{n}}}{2 \, {\left({n} - 1\right)} \, \sin\left(\frac{\pi}{2n}\right)}
\end{align*}
</div>
<p>or a more general result, for <span class="math">\(k \ge n\)</span></p>
<div class="math">
\begin{equation*}
\displaystyle \int_0^\infty \, \frac{\arctan{(a\,(x^k))}}{x^{n}}\, dx =\frac{\pi \, a^{\frac{n-1}{k}}}{2 \, {\left({n} - 1\right)} \, \sin\left(\frac{k-n+1}{2\, k}\, \pi\right)}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_0^{\pi/2} \, \log{\left(1+a\, \sin(x)^{2}\right)}\, dx = \pi\, \log{\left(\frac{\sqrt{a+1}+1}{2}\right)}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_0^{\infty} \, e^{-a\sqrt{x}}\, \frac{\sin{\sqrt{x}}}{x}\, dx = \pi - 2\, \arctan{a}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \displaystyle \int_0^{\infty} \, \frac{\log{\left(1+\frac{a}{x^{3}}\right)}}{1+x^{3}}\, dx = \frac{1}{3\, \sqrt{3}} \, {\left(2 \, \sqrt{3} \pi \arctan\left(\frac{1}{\sqrt{3}} \, {\left(2 \, a^{\frac{1}{3}} + 1\right)}\right) + 3 \, \pi \log\left(a^{\frac{2}{3}} + a^{\frac{1}{3}} + 1\right)\right)}-\frac{\pi^{2}}{9}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \displaystyle \int_0^{\infty} \, \frac{x\, \log{\left(1+\frac{a}{x^{3}}\right)}}{1+x^{3}}\, dx = \frac{\pi^{2}}{9}-\frac{1}{3\, \sqrt{3}} \, {\left(2 \, \sqrt{3} \pi \arctan\left(\frac{1}{\sqrt{3}} \, {\left(2 \, a^{\frac{1}{3}} + 1\right)}\right) - 3 \, \pi \log\left(a^{\frac{2}{3}} + a^{\frac{1}{3}} + 1\right)\right)}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_0^{\infty} \, \log\left(\frac{a^{2} x^{2} + 1}{a^{2} + 1}\right)\, \frac{1}{1-x^{2} }\, dx = -\arctan(a)^2
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_0^{1} \frac{\log\left(1+a x \right)}{x\, \sqrt{1-x^{2}} }\, dx = \frac{1}{2}\, \log{\left(\sqrt{a^2-1}+a\right)}^{2}+\frac{\pi^2}{8}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_{0}^{\infty}\, \frac{\log\left(a x + b\right)}{{\left(x + 1\right)}^{2}}\, dx = \frac{a \log\left(a\right) - b \log\left(b\right)}{a - b}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_{0}^{\infty}\, \frac{e^{-a x^{2}} \sin\left(b\, x\right)^{2}}{x^{2}}\, dx = \frac{1}{2} \, \sqrt{\pi} {\left(b\, \sqrt{\pi}\, \text{erf}\left(\frac{b}{\sqrt{a}}\right) + \sqrt{a} e^{-b^{2}/a}\right)} - \frac{1}{2} \, \sqrt{\pi\, a}
\end{equation*}
</div>
</li>
<li>
<p class="first">This integral is different. The rule is applied twice, and integrated back twice, finding the constant of integration each time.</p>
<div class="math">
\begin{equation*}
\displaystyle \int_{0}^{\infty}\, \frac{e^{\left(-a x\right)} \sin\left(b x\right)^{5}}{x^{2}}\, dx = -\frac{3}{16} \, \pi a - \frac{5}{32} \, b {\left(\log\left(25\right) - 3 \, \log\left(9\right)\right)} + \frac{5}{8} \, a \arctan\left(\frac{a}{b}\right) - \frac{5}{16} \, a \arctan\left(\frac{a}{3 \, b}\right) + \frac{1}{16} \, a \arctan\left(\frac{a}{5 \, b}\right) - \frac{5}{32} \, b \log\left(\frac{a^{2} + 25 \, b^{2}}{25 \, b^{2}}\right) + \frac{15}{32} \, b \log\left(\frac{a^{2} + 9 \, b^{2}}{9 \, b^{2}}\right) - \frac{5}{16} \, b \log\left(\frac{a^{2} + b^{2}}{b^{2}}\right)
\end{equation*}
</div>
</li>
<li>
<p class="first">More complicated than the previous, the rule is to be applied 5 times:</p>
<div class="math">
\begin{equation*}
\displaystyle \int_{0}^{\infty}\, \frac{e^{\left(-a x\right)} \sin\left(b x\right)^{5}}{x^{5}}\, dx = \frac{1}{128} \, \pi a^{4} + \frac{5}{64} \, \pi a^{2} b^{2} + \frac{115}{384} \, \pi b^{4} - \frac{5}{192} \, a^{4} \arctan\left(\frac{a}{b}\right) + \frac{5}{32} \, a^{2} b^{2} \arctan\left(\frac{a}{b}\right) - \frac{5}{192} \, b^{4} \arctan\left(\frac{a}{b}\right) + \frac{5}{384} \, a^{4} \arctan\left(\frac{a}{3 \, b}\right) - \frac{45}{64} \, a^{2} b^{2} \arctan\left(\frac{a}{3 \, b}\right) + \frac{135}{128} \, b^{4} \arctan\left(\frac{a}{3 \, b}\right) - \frac{1}{384} \, a^{4} \arctan\left(\frac{a}{5 \, b}\right) + \frac{25}{64} \, a^{2} b^{2} \arctan\left(\frac{a}{5 \, b}\right) - \frac{625}{384} \, b^{4} \arctan\left(\frac{a}{5 \, b}\right) + \frac{5}{192} \, a^{3} b \log\left(25\right) - \frac{5}{64} \, a^{3} b \log\left(9\right) - \frac{125}{192} \, a b^{3} \log\left(a^{2} + 25 \, b^{2}\right) + \frac{45}{64} \, a b^{3} \log\left(a^{2} + 9 \, b^{2}\right) - \frac{5}{96} \, a b^{3} \log\left(a^{2} + b^{2}\right) + \frac{5}{96} \, a^{3} b \log\left(\frac{a^{2}}{b^{2}} + 1\right) - \frac{5}{64} \, a^{3} b \log\left(\frac{a^{2}}{9 \, b^{2}} + 1\right) + \frac{5}{192} \, a^{3} b \log\left(\frac{a^{2}}{25 \, b^{2}} + 1\right)
\end{equation*}
</div>
<p>So, if <span class="math">\(a=0\)</span>, it reduces to a simpler form:</p>
<div class="math">
\begin{equation*}
\displaystyle \int_{0}^{\infty}\, \frac{\sin\left(b x\right)^{5}}{x^{5}}\, dx =\frac{115}{384} \, \pi b^{4}
\end{equation*}
</div>
<p>In Sage, it can be applied as:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-0"> 0</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-1"> 1</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-2"> 2</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-3"> 3</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-4"> 4</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-5"> 5</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-6"> 6</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-7"> 7</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-8"> 8</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-9"> 9</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-10">10</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-11">11</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-12">12</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-13">13</a>
<a href="posts/interesting-definite-integrals/#rest_code_3c3bf98e4f5e42569801c6644f144f43-14">14</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-0"></a><span class="c1"># Takes a few seconds</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-1"></a><span class="n">var</span><span class="p">(</span><span class="s1">'a b'</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-2"></a><span class="n">forget</span><span class="p">()</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-3"></a><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-4"></a><span class="n">intg</span> <span class="o">=</span> <span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-5"></a><span class="n">tmp</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">intg</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">oo</span><span class="p">),</span><span class="n">a</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-6"></a><span class="n">h1</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">-</span><span class="n">limit</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-7"></a><span class="n">tmp</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">h1</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-8"></a><span class="n">h2</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">-</span><span class="n">limit</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-9"></a><span class="n">tmp</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">h2</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-10"></a><span class="n">h3</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">-</span><span class="n">limit</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-11"></a><span class="n">tmp</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">h3</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-12"></a><span class="n">h4</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">-</span><span class="n">limit</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-13"></a><span class="n">tmp</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">h4</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="p">)</span>
<a name="rest_code_3c3bf98e4f5e42569801c6644f144f43-14"></a><span class="n">h5</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">-</span><span class="n">limit</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
</pre></td>
</tr></table>
</li>
<li>
<div class="first math">
\begin{align*}
\displaystyle \int_{0}^{\pi/2}\, e^{-b\, \sec{(x)}^{2}} \, \sin{(a\, \tan{x})}^{2} \, dx \\ =\frac{\pi}{4}\left(1 - e^{-2 \, a}\right) -\frac{1}{8} \, \pi {\left({\rm erfc}\left(\frac{a}{\sqrt{b}} + \sqrt{b}\right) e^{\left(4 \, a\right)} + {\rm erfc}\left(-\frac{a}{\sqrt{b}} + \sqrt{b}\right) - 2\right)} e^{\left(-2 \, a\right)} - \frac{1}{4} \, \pi \text{erf}\left(\sqrt{b}\right)
\end{align*}
</div>
<p>or in particular, when <span class="math">\(b \to 0\)</span>,</p>
<div class="math">
\begin{equation*}
\displaystyle \int_{0}^{\pi/2}\, \sin{(a\, \tan{x})}^{2} \, dx =\frac{\pi}{4}\left(1 - e^{-2 \, a}\right)
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_{0}^{\infty}\, \frac{\log{(1+a\, x^3)}}{(1-x+x^2)}\, dx = \frac{2}{\sqrt{3}} \, \pi \, \log\left(1+ a^{\frac{1}{3}} + a^{\frac{2}{3}} \right)
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_{0}^{1}\, \frac{\arctan{a\, x}}{x\, \sqrt{1-x^2}}\, dx = \frac{\pi}{2} \, \sinh^{-1}{a}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{align*}
\displaystyle \int_{0}^{1}\, \frac{\log{\left(1+a\, x\, (1-x)\right)}}{x}\, dx = \sum_{i=1}^{\infty}\frac{(-1)^{i-1} a^{i}}{i^{2}\, \binom{2i}{i}} = \frac{1}{2}\, \log\left( \frac{a+2 -\sqrt{a^{2} + 4 \, a}}{2}\right)^{2}\\ \implies \sum_{i=1}^{\infty}\frac{1}{i^{2}\, \binom{2i}{i}} =\frac{\pi^{2}}{18} \\ \phantom{\implies}\sum_{i=1}^{\infty}\frac{2^{i}}{i^{2}\, \binom{2i}{i}} =\frac{\pi^{2}}{8} \text{ etc.}
\end{align*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_{0}^{\pi}\, \log{\left(1-2\, a\, \cos{x} + a^{2}\right)}\, dx = 2\, \pi\, \log{|a|}
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_0^{\pi/4} \frac{\left(\log{\tan{\left(\frac{\pi}{4}+ x\right)}}\right)^n}{\tan{(2x)}}\, dx = \frac{n!}{2^n} \left(1-\frac{1}{2^{n + 1}}\right) \zeta(n + 1)
\end{equation*}
</div>
</li>
<li>
<div class="first math">
\begin{equation*}
\displaystyle \int_0^1 \log\frac{\big(x+a\, \sqrt{1-x^2}\big)^2}{\big(x-a\, \sqrt{1-x^2}\big)^2} \frac{x\, dx}{1-x^2} = 2\,\pi\arctan{a}
\end{equation*}
</div>
</li>
<li>
<p class="first">The functions in the answer are Beta and the Polygamma:</p>
<div class="math">
\begin{equation*}
\displaystyle \int_0^{\pi/2}\, \frac{\sin(x)^a\, \log{\sin{x}}}{\sqrt{1+\sin(x)^2}}\, dx = \frac{1}{16} \, {\left(\psi_0\left(\frac{a+1}{4} \right)-\psi_0\left(\frac{a+3}{4} \right) \right)} {\rm B}\left(\frac{a+1}{4},\frac{1}{2}\right)
\end{equation*}
</div>
</li>
</ol>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-6.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-4.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script>
</div>
        <!--End of body content-->

        <footer id="footer"></footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
