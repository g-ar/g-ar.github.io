<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Some random stuffs -- Programming and Mathematics">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gopinath A R (old posts, page 2) | Gopinath A R</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://g-ar.github.io/index-2.html">
<link rel="prev" href="index-3.html" type="text/html">
<link rel="next" href="index-1.html" type="text/html">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://g-ar.github.io/">

                <span id="blog-title">Gopinath A R</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>
                </li>
<li>
<a href="stories/about-me/">About</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/" class="u-url">Using directed graphs to count the number of patterns</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/" rel="bookmark"><time class="published dt-published" datetime="2014-02-12T20:43:44+05:30" title="2014-02-12 20:43">2014-02-12 20:43</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p><em>How many n-digit numbers are there which do not contain 122 and 213 in them? Numbers start with a nonzero digit.</em></p>
<p>We can write a directed graph to solve that, the weighted adjacency matrix for which is given by:</p>
<div class="math">
\begin{equation*}
\displaystyle D = \left(\begin{array}{ccccccc} &amp; I &amp; A &amp; 1 &amp; 2 &amp; 12 &amp; 21 \\ I &amp; 0 &amp; 7 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\ A &amp; 0 &amp; 8 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 8 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\ 2 &amp; 0 &amp; 8 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\ 12 &amp; 0 &amp; 8 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 21 &amp; 0 &amp; 7 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \end{array}\right)
\end{equation*}
</div>
<p>'I' is the initial state, '1' and '2' are the states if those digits are the last encountered.
<span class="math">\(A\)</span> is for any other valid digits. It goes to state <span class="math">\(12\)</span> or <span class="math">\(21\)</span> if we see a sequence of 12 or 21, respectively. The number of ways of valid transitions are given as the weights.</p>
<p>There, the hard work is done. Leave the remaining to Sage!</p>
<p>Obtain the characteristic polynomial of the matrix, which also is the characteristic equation of the required recurrence equation.</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-1">1</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-2">2</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-3">3</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-4">4</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-5">5</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-6">6</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-7">7</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-8">8</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_7c517451b06c449e9f836911fd816758-9">9</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_7c517451b06c449e9f836911fd816758-1"></a><span class="n">am</span><span class="o">=</span><span class="n">matrix</span><span class="p">([</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-2"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-3"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-4"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-5"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-6"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-7"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-8"></a><span class="p">])</span>
<a name="rest_code_7c517451b06c449e9f836911fd816758-9"></a><span class="k">print</span> <span class="n">am</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span>
</pre></td>
</tr></table>
<p>The characteristic equation is:</p>
<div class="math">
\begin{equation*}
\displaystyle x^{5} - 10x^{4} + 2x^{2} - 1 = 0
\end{equation*}
</div>
<p>So, the recurrence would be:</p>
<div class="math">
\begin{align*}
\displaystyle a_{i+5}&amp;=10\, a_{i+4}-2\, a_{i+2}+a_{i} \\
a_{0}&amp;=1\\
a_{1}&amp;= 9\\
a_{2}&amp;= 90\\
a_{3}&amp;= 898\\
a_{4}&amp;= 8962\\
\end{align*}
</div>
<p>Wonder if anyone can come up with a combinatorial argument for that equation?!</p>
<p>Initial conditions can be easily obtained by matrix exponentiation or using a program to iterate through the sequences, e.g.</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_9224fe433531408292d019a08b726810-1">1</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_9224fe433531408292d019a08b726810-1"></a><span class="k">print</span> <span class="nb">sum</span><span class="p">((</span><span class="n">am</span><span class="o">^</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
</pre></td>
</tr></table>
<p>or</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_e39a0e03604b43aebee8f542c3009052-1">1</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_e39a0e03604b43aebee8f542c3009052-2">2</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_e39a0e03604b43aebee8f542c3009052-3">3</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_e39a0e03604b43aebee8f542c3009052-4">4</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_e39a0e03604b43aebee8f542c3009052-5">5</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_e39a0e03604b43aebee8f542c3009052-1"></a><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_e39a0e03604b43aebee8f542c3009052-2"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">):</span>
<a name="rest_code_e39a0e03604b43aebee8f542c3009052-3"></a>    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'122'</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'213'</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
<a name="rest_code_e39a0e03604b43aebee8f542c3009052-4"></a>        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_e39a0e03604b43aebee8f542c3009052-5"></a><span class="k">print</span> <span class="n">cnt</span>
</pre></td>
</tr></table>
<p>We can also automatically get the generating function of the obtained recurrence by using a small program (method is given in "Lectures on generating functions" by S. K. Lando):</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_4633a608b8ab4bbabe0192f8529bfa96-1">1</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_4633a608b8ab4bbabe0192f8529bfa96-2">2</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_4633a608b8ab4bbabe0192f8529bfa96-3">3</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_4633a608b8ab4bbabe0192f8529bfa96-4">4</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_4633a608b8ab4bbabe0192f8529bfa96-5">5</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_4633a608b8ab4bbabe0192f8529bfa96-6">6</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_4633a608b8ab4bbabe0192f8529bfa96-1"></a><span class="k">def</span> <span class="nf">get_gf</span><span class="p">(</span><span class="n">alst</span><span class="p">,</span><span class="n">initvals</span><span class="p">):</span>
<a name="rest_code_4633a608b8ab4bbabe0192f8529bfa96-2"></a>    <span class="n">nn</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">alst</span><span class="p">)</span>
<a name="rest_code_4633a608b8ab4bbabe0192f8529bfa96-3"></a>    <span class="n">Am</span> <span class="o">=</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">nn</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="n">nn</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">alst</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a name="rest_code_4633a608b8ab4bbabe0192f8529bfa96-4"></a>    <span class="n">Bm</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">initvals</span><span class="p">)</span>
<a name="rest_code_4633a608b8ab4bbabe0192f8529bfa96-5"></a>    <span class="k">return</span> <span class="p">(((</span><span class="n">identity_matrix</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">Am</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">Bm</span><span class="o">.</span><span class="n">transpose</span><span class="p">())[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<a name="rest_code_4633a608b8ab4bbabe0192f8529bfa96-6"></a><span class="k">print</span> <span class="n">get_gf</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">898</span><span class="p">,</span><span class="mi">8962</span><span class="p">])</span>
</pre></td>
</tr></table>
<p>which gives the g.f.</p>
<div class="math">
\begin{equation*}
\displaystyle G(x)=\frac{x - 1}{x^{5} - 2 \, x^{3} + 10 \, x - 1}
\end{equation*}
</div>
<p>There are tremendous uses of generating functions, one of which is to obtain an asymptotic formula. (See William Feller's book on probability for a brief explanation on the topic)</p>
<p>If we have a generating function of the form <span class="math">\(G(x)=U(x)/V(x)\)</span>, then the asymptotic form is given by</p>
<div class="math">
\begin{equation*}
\displaystyle a_n \sim \dfrac{\rho_1}{s_1^{n+1}}
\displaystyle \textrm{where }\rho_1=\dfrac{-U(s_1)}{V^{'}(s_1)}
\displaystyle \textrm{and }s_1 \textrm{ is the root of }V(x)\textrm{ nearest to origin}
\end{equation*}
</div>
<p>We will visually inspect where the roots lie, to get an idea about the closest root to the origin</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_da9ed170efeb4e3baa8094ec5fce3848-1">1</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_da9ed170efeb4e3baa8094ec5fce3848-1"></a><span class="n">complex_plot</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></td>
</tr></table>
<div class="figure">
<img alt="../../images/complexroot.jpg" src="images/complexroot.jpg"><p class="caption">complex plot of the equation</p>
</div>
<p>and we see that there is only one real root (also the nearest to origin) and other four are complex.</p>
<p>We can proceed with the following steps in Sage:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_a31136e03e874dba9490b81f373d242a-1">1</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_a31136e03e874dba9490b81f373d242a-2">2</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_a31136e03e874dba9490b81f373d242a-3">3</a>
<a href="posts/using-directed-graphs-to-count-the-number-of-patterns/#rest_code_a31136e03e874dba9490b81f373d242a-4">4</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_a31136e03e874dba9490b81f373d242a-1"></a><span class="n">s1</span><span class="o">=</span><span class="n">find_root</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="rest_code_a31136e03e874dba9490b81f373d242a-2"></a><span class="n">rho1</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">s1</span><span class="p">)</span><span class="o">/</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">s1</span><span class="p">)</span>
<a name="rest_code_a31136e03e874dba9490b81f373d242a-3"></a><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">rho1</span><span class="o">/</span><span class="n">s1</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_a31136e03e874dba9490b81f373d242a-4"></a><span class="k">print</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">15</span><span class="p">)),</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>We find the approximation to be</p>
<div class="math">
\begin{equation*}
\displaystyle a_n \sim \frac{0.0905207193521}{0.100200193518^{n + 1}}
\end{equation*}
</div>
<p>The <span class="math">\(15^{th}\)</span> term using the asymptotic formula gives about <span class="math">\(876700051238642\)</span>, which is only a little more than the actual value of <span class="math">\(876700051238641\)</span>.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/" class="u-url">Expected number of marbles to be picked till one of the colours are repeated</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/" rel="bookmark"><time class="published dt-published" datetime="2014-02-11T20:38:26+05:30" title="2014-02-11 20:38">2014-02-11 20:38</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p><em>There is a bag having 3 red, 3 black, 5 white and 7 green marbles. A marble is randomly picked one after another without replacement till the colour of the picked marble matches with one of the marbles in hand. What is the expected number of marbles we need to pick?</em></p>
<p>Before trying out the analytical solution, let us get an approximate answer from a simulation.
It's just some tens of characters in J:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_f2dde12605734301b25fba9084910c4b-1">1</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_f2dde12605734301b25fba9084910c4b-2">2</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_f2dde12605734301b25fba9084910c4b-3">3</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_f2dde12605734301b25fba9084910c4b-1"></a>a=:(3#0 1),(5#2),(7#3)
<a name="rest_code_f2dde12605734301b25fba9084910c4b-2"></a>sim =: 3 : '{.1+I.-.~:(5?#a){a'
<a name="rest_code_f2dde12605734301b25fba9084910c4b-3"></a>(+/%#)(sim "0) 100000#0 NB. about 3.25279
</pre></td>
</tr></table>
<p>sample size of 5 is chosen by pigeonhole principle.</p>
<ul class="simple">
<li>
<tt class="docutils literal">~:</tt> returns 1 for items which are distinct till that position.</li>
<li>
<tt class="docutils literal"><span class="pre">-.</span></tt> flips the 1's and 0's.</li>
<li>
<tt class="docutils literal">I.</tt> fetches the indices of non-zero items. 1 added since indexing starts from 0.</li>
<li>
<tt class="docutils literal">{.</tt> gets the head of the array.</li>
</ul>
<p>For the analytical solution, it can be simply expressed as a recurrence relation:</p>
<div class="math">
\begin{equation*}
\displaystyle f_{a,b,c,d} = \begin{cases} A+B+C+D-(a+b+c+d) &amp; A-a = 2 \lor B-b = 2 \lor C-c = 2 \lor D-d = 2\\ &amp; \\ \dfrac{1}{a+b+c+d}\left(a\cdot f_{a-1,b,c,d} + b\cdot f_{a,b-1,c,d} + c\cdot f_{a,b,c-1,d} + d\cdot f_{a,b,c,d-1}\right) &amp; \text{otherwise} \end{cases}
\end{equation*}
</div>
<p>where <span class="math">\(A,B,C,D\)</span> are the initial number of marbles of four colours.</p>
<p>And it can be directly translated to code.</p>
<p>In Sage:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-1"> 1</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-2"> 2</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-3"> 3</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-4"> 4</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-5"> 5</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-6"> 6</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-7"> 7</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-8"> 8</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-9"> 9</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_284cd72972bf41a0b620b5f7dc18908f-10">10</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-1"></a><span class="n">A</span> <span class="o">=</span> <span class="mi">3</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-2"></a><span class="n">B</span> <span class="o">=</span> <span class="mi">3</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-3"></a><span class="n">C</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-4"></a><span class="n">D</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-5"></a><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">):</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-6"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">a</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">B</span><span class="o">-</span><span class="n">b</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">C</span><span class="o">-</span><span class="n">c</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">D</span><span class="o">-</span><span class="n">d</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-7"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="o">+</span><span class="n">D</span><span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">))</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-8"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-9"></a><span class="n">ans</span><span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<a name="rest_code_284cd72972bf41a0b620b5f7dc18908f-10"></a><span class="k">print</span> <span class="n">ans</span><span class="p">,</span> <span class="n">N</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span> <span class="c1"># = 3979/1224 and N() for the numerical approximation = 3.25081699346405</span>
</pre></td>
</tr></table>
<p>Here's an exercise for you to try:</p>
<p>Repeat the same problem, this time with the replacement of the marbles. What's the expected number of number of picks till you see the same coloured marble again?</p>
<p>Simulation is easy:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_4e9f71f100ac4b05a52d995746c26ba5-1">1</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_4e9f71f100ac4b05a52d995746c26ba5-2">2</a>
<a href="posts/expected-number-of-marbles-to-be-picked-till-one-of-the-colours-are-repeated/#rest_code_4e9f71f100ac4b05a52d995746c26ba5-3">3</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_4e9f71f100ac4b05a52d995746c26ba5-1"></a>a=:(3#0 1),(5#2),(7#3)
<a name="rest_code_4e9f71f100ac4b05a52d995746c26ba5-2"></a>sim =: 3 : '{.1+I.-.~:(?5##a){a'
<a name="rest_code_4e9f71f100ac4b05a52d995746c26ba5-3"></a>(+/%#)(sim "0) 100000#0
</pre></td>
</tr></table>
<p>In a similar fashion, the recurrence can be modified. (Ans: <span class="math">\(757/243\)</span>)</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/simulating-buffons-needle-problem/" class="u-url">Simulating Buffon's needle problem</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/simulating-buffons-needle-problem/" rel="bookmark"><time class="published dt-published" datetime="2014-02-10T20:32:53+05:30" title="2014-02-10 20:32">2014-02-10 20:32</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p>Buffon's needle problem is a classic problem on geometric probability. mathworld describes the problem quite well, and gives the following formula for the probability that the needle touches a line:</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}(x)=\begin{cases} \dfrac{2}{\pi}\, x&amp; x\le 1\\ &amp; \\ \dfrac{2}{\pi}\, \left(x-\sqrt{x^2-1}+\sec^{-1}{x}\right)&amp; x&gt;1 \end{cases}
\end{equation*}
</div>
<p>How can we convince ourselves that the formula has been derived correctly? How to simulate geometric shapes?</p>
<p>The answer is to use the parametric representation of the points. If the needle of length <span class="math">\(l\)</span> is dropped, then it makes an angle <span class="math">\(\theta\)</span> with the horizontal. For simulating, take one end of the needle as a reference, and it must be randomly and uniformly distributed in <span class="math">\([0,d)\)</span>. Call the random number as <span class="math">\(h\)</span>. The other end of the needle will then be at a distance <span class="math">\(h+l\cdot sin(\theta)\)</span>.</p>
<p>Now, for the condition that the needle touches the line, the other end must be either higher than <span class="math">\(d\)</span> or less than zero. Hence, we can simulate the experiment by picking <span class="math">\(h\)</span> in <span class="math">\(U(0,d)\)</span> and <span class="math">\(\theta \in U(0,2\, \theta)\)</span>.</p>
<p>Following is the code in J:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-1">1</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-2">2</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-3">3</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-4">4</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-5">5</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-6">6</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-7">7</a>
<a href="posts/simulating-buffons-needle-problem/#rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-8">8</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-1"></a>load 'trig'
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-2"></a>'l d'=:4 1
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-3"></a>    sim =: 3 : 0
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-4"></a>h=:d*?1000000#0
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-5"></a>th=:2p1*?1000000#0
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-6"></a>(+/%#)((h+l*sin th)&gt;d)+.((h+l*sin th)&lt;0)
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-7"></a>)
<a name="rest_code_f1a0bd60d0dc479a9ecd41fecaa06adb-8"></a>    sim 0
</pre></td>
</tr></table>
<p>It gives an answer about <span class="math">\(0.919978\)</span>, and changing <span class="math">\(l\)</span> and <span class="math">\(d\)</span> to</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/simulating-buffons-needle-problem/#rest_code_c7c1fe04e67b49bf883fdf00616cd66d-1">1</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_c7c1fe04e67b49bf883fdf00616cd66d-1"></a>'l d'=:1 4
</pre></td>
</tr></table>
<p>gives about <span class="math">\(0.15907\)</span>, which are close to actual answers <span class="math">\(0.920000066713994\)</span> and <span class="math">\(0.159154943091895\)</span>, respectively.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/monte-carlo-simulation-for-an-expected-value-of-cards/" class="u-url">Monte-Carlo simulation for an expected value of cards</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Gopinath
            </span></p>
            <p class="dateline"><a href="posts/monte-carlo-simulation-for-an-expected-value-of-cards/" rel="bookmark"><time class="published dt-published" datetime="2014-02-09T20:17:59+05:30" title="2014-02-09 20:17">2014-02-09 20:17</time></a></p>
        </div>
    </header><div class="e-content entry-content">
    <div>
<p><em>Suppose we have a standard deck of 52 cards, and we pick 13 cards randomly and arrange them in a row, what is the expected number of adjacent pairs that are of same suit?</em></p>
<p>E.g. in ♠♥♥♣♦♣♣♦♦♣♠♠♣ , there are 4 adjacent pairs that are of same suit. On an average, what would be the expected number of such pairs?</p>
<p>Newcomers to probability theory would find such a question a bit tricky. In such a situation, using a computer for simulation/enumeration would ease the job. For this problem, enumeration can yield the exact answer, but getting all the combinations is awkward.</p>
<p>In such cases, simulation is there for our rescue! Even an approximate answer would be sufficient to conjecture a formula.</p>
<p>For the simulation, we will be using a language called <a class="reference external" href="https://jsoftware.com">J</a>. The programs written in J can be very short compared to other well known languages. So, we can focus on the problem at hand instead of the program.</p>
<p>Let's see how it can be used for our simulation (there can be other ways, here’s my shot):</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="posts/monte-carlo-simulation-for-an-expected-value-of-cards/#rest_code_20738831a5944e41b0c28ffbacde08d4-1">1</a>
<a href="posts/monte-carlo-simulation-for-an-expected-value-of-cards/#rest_code_20738831a5944e41b0c28ffbacde08d4-2">2</a>
<a href="posts/monte-carlo-simulation-for-an-expected-value-of-cards/#rest_code_20738831a5944e41b0c28ffbacde08d4-3">3</a></pre></div></td>
<td class="code"><pre class="code text"><a name="rest_code_20738831a5944e41b0c28ffbacde08d4-1"></a>a=:13#(i.4)
<a name="rest_code_20738831a5944e41b0c28ffbacde08d4-2"></a>sim=: 3 : '+/2=/\(13?52){a'
<a name="rest_code_20738831a5944e41b0c28ffbacde08d4-3"></a>(+/%#)(sim "0) 1000000#0
</pre></td>
</tr></table>
<p>That's it, less than 70 characters! It output <span class="math">\(2.82489\)</span> for me. When we are proceeding with an analytical method, if we get an answer around <span class="math">\(2.82\)</span>, then we can be pretty sure that it's right.</p>
<p>Some explanation about the program:</p>
<p>In J, every operation is performed right to left, if no parentheses are provided.
So, if we write <tt class="docutils literal">2*5+3</tt>, answer would be <tt class="docutils literal">16</tt> and not <tt class="docutils literal">13</tt>. No operator precedence here.</p>
<p>In J terminology, the operators are called verbs. They can be monadic or dyadic. Check the help files for more info.</p>
<ol class="arabic simple">
<li>
<tt class="docutils literal">i.4</tt> is array of integers <tt class="docutils literal">0 1 2 3</tt>, representing 4 suits. <tt class="docutils literal">13#</tt> repeats each element 13 times.</li>
<li>
<tt class="docutils literal">sim</tt> is the function for our simulation. Read it right to left. <tt class="docutils literal">{</tt> is the verb for indexing.<ul>
<li>
<tt class="docutils literal"><span class="pre">(13?52)</span></tt> gets 13 random integers in <tt class="docutils literal"><span class="pre">0..51</span></tt> without replacement, to simulate 13 card draws.</li>
<li>
<tt class="docutils literal"><span class="pre">2=/\</span></tt> compares two adjacent values from the selected list, and returns 1 or 0 for true or false, respectively.</li>
<li>
<tt class="docutils literal">+/</tt> gives us the sum of the array, which is the total number of pairs with same adjacent suit.</li>
</ul>
</li>
<li>" is a verb for rank. "0 gets atomic values in the rhs, i.e. a million zeros, the rhs is not used in our simulation, it's just for performing the experiment a million times. The outcome of each experiment is then averaged, by using the tacit definition <tt class="docutils literal"><span class="pre">(+/%#)</span></tt>. This last line almost always remains the same for any similar kind of simulation.</li>
</ol>
<p>Lastly, experiment with different number of picks and observe how answer is changing according to that.</p>
<p>Now, for the analytical result, the linearity of expectation is used.</p>
<p>The probability that the card in positions i and i+1 are of the same suit is given by</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}[c_i=c_{i+1} | c_i \text{ is spade}] = \frac{13}{52}\cdot \frac{12}{51}
\end{equation*}
</div>
<p>and similarly for three other suits. The total probability is then</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{P}[c_i=c_{i+1}] = \frac{13}{52}\cdot \frac{12}{51} \times 4 = \frac{4}{17}
\end{equation*}
</div>
<p>This is also the expected number of pairs of the same suit when two cards are picked. We write the expected value as</p>
<div class="math">
\begin{equation*}
\displaystyle \mathbb{E}[c_i=c_{i+1}] = \frac{4}{17}
\end{equation*}
</div>
<p>Hence, by linearity of expectation, when ‘n’ cards are picked, we can expect</p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{i=1}^{n}\mathbb{E}[c_i=c_{i+1}] = \frac{4\, (n-1)}{17}
\end{equation*}
</div>
<p>adjacent pairs to be of the same suit.</p>
<p>For <span class="math">\(n=13\)</span>, it would be <span class="math">\(48/17\)</span>, or <span class="math">\(2.82352941176471\)</span> cards, which agrees with the simulation.</p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-3.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script>
</div>
        <!--End of body content-->

        <footer id="footer"></footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
