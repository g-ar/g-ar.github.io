<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Applications of Generating Functions | Gopinath A R</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://g-ar.github.io/posts/applications-of-generating-functions/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Gopinath">
<link rel="prev" href="../interesting-images-2/" title="Interesting images - 2" type="text/html">
<link rel="next" href="../josephus-problem-c-versus-j/" title="Josephus problem -- C versus J" type="text/html">
<meta property="og:site_name" content="Gopinath A R">
<meta property="og:title" content="Applications of Generating Functions">
<meta property="og:url" content="https://g-ar.github.io/posts/applications-of-generating-functions/">
<meta property="og:description" content="Generating Function (g.f.) is one of the most important tools in combinatorics. Many problems which are difficult to do by combinatorial arguments and by cases are trivial when g.f. is applied. Below ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-03-19T20:54:04+05:30">
<meta property="article:tag" content="diophantine equations">
<meta property="article:tag" content="expected value">
<meta property="article:tag" content="generating function">
<meta property="article:tag" content="infinite series">
<meta property="article:tag" content="mathjax">
<meta property="article:tag" content="probability">
<meta property="article:tag" content="sage">
<meta property="article:tag" content="summation">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://g-ar.github.io/">

                <span id="blog-title">Gopinath A R</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../../stories/about-me/">About</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Applications of Generating Functions</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                    Gopinath
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2014-03-19T20:54:04+05:30" itemprop="datePublished" title="2014-03-19 20:54">2014-03-19 20:54</time></a></p>
            
        <p class="sourceline"><a href="index.rst" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>Generating Function (g.f.) is one of the most important tools in combinatorics. Many problems which are difficult to do by combinatorial arguments and by cases are trivial when g.f. is applied. Below are some typical problems where g.f. are very useful.</p>
<div class="section" id="solving-diophantine-equations-d-e">
<h2>1 Solving diophantine equations (d.e.)</h2>
<ol class="loweralpha simple">
<li>What are the number of solutions for the linear d.e.</li>
</ol>
<div class="math">
\begin{align*}
\displaystyle x_1+x_2+x_3+x_4=35\\ 1\le x_1,x_2\le 20\\ 20\le x_3,x_4 \le 30
\end{align*}
</div>
<p>Answer can be easily found by representing the variables as polynomials and multiplying them, i.e.</p>
<div class="math">
\begin{equation*}
\displaystyle [z^{35}](z+z^2+z^3+\cdots +z^{20})^2\, (z^{20}+z^{21}+z^{22}+\cdots +z^{30})^2 = 11
\end{equation*}
</div>
<p>Hence, there are 11 solutions for the d.e under the constraints.</p>
<p>In Sage, this can be found by the taylor expansion:</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_fe17251cbb6b4095b845a926d864ccce-1">1</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_fe17251cbb6b4095b845a926d864ccce-1"></a><span class="n">taylor</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">21</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">20</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">31</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">35</span><span class="p">)</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">35</span><span class="p">)</span>
</pre></td>
</tr></table>
<p>We can even get a closed form if the problem is changed to</p>
<div class="math">
\begin{align*}
\displaystyle x_1+x_2+x_3+x_4=n\\ 0\le x_1,x_2, x_3,x_4
\end{align*}
</div>
<p>The g.f. for this is written as</p>
<div class="math">
\begin{equation*}
\displaystyle (1+z+z^2+z^3+\cdots)^4=\dfrac{1}{(1-z)^4}
\end{equation*}
</div>
<p>and the nth coeffiecient is</p>
<div class="math">
\begin{equation*}
\displaystyle [z^n]\dfrac{1}{(1-z)^4}=\dbinom{n+3}{3}
\end{equation*}
</div>
<p>b) Number of ways to make changes for n units using coins of denominations 1,2 and 5 units.
The d.e. for this problem is written as</p>
<div class="math">
\begin{equation*}
\displaystyle x_1+2\, x_2+5\, x_3=n
\end{equation*}
</div>
<p>and the g.f. is</p>
<div class="math">
\begin{equation*}
\displaystyle G(z)=\dfrac{1}{(1-z)(1-z^2)(1-z^5)}
\end{equation*}
</div>
<p>The <span class="math">\(n^{th}\)</span> coefficient gets the exact answer, but having a g.f. allows us to do more, like having an asymptotic form.
In this case, factor the denominator</p>
<div class="math">
\begin{equation*}
\displaystyle G(z)=\dfrac{1}{(1-z)^3}\cdot \dfrac{1}{(1+z)(1+z+z^2+z^3+z^4)}
\end{equation*}
</div>
<p>The first part of the two fractions contributes the most to the coefficients, and an approximation can be written as</p>
<div class="math">
\begin{equation*}
\displaystyle [z^n]G(z)\sim [z^n]\dfrac{1}{(1-z)^3}\cdot \lim_{z\to 1}\dfrac{1}{(1+z)(1+z+z^2+z^3+z^4)} =\dfrac{\dbinom{n+2}{2}}{10}
\end{equation*}
</div>
<p>Comparing the precise and approximate answers:
for <span class="math">\(n=1000\)</span>
<span class="math">\(50401\)</span> and <span class="math">\(50150.1\)</span>,</p>
<p>for <span class="math">\(n=2000\)</span>
200801 and 200301.1,
respectively.</p>
</div>
<div class="section" id="partial-and-infinite-sums">
<h2>2 Partial and infinite sums</h2>
<ol class="loweralpha simple">
<li>Finding a closed form for</li>
</ol>
<div class="math">
\begin{equation*}
\displaystyle \sum_{k=1}^n k
\end{equation*}
</div>
<p>For problems like this, we can make use of the property of g.f:</p>
<div class="math">
\begin{align*}
\displaystyle G(z)=\sum_{i\ge 0} a_i\, x^i\\ \implies \dfrac{1}{1-z}G(z)=\sum_{i\ge 0}\left(\sum_{j=0}^i a_j \right)z^i
\end{align*}
</div>
<p>G.f. for <span class="math">\(&lt;0,1,2,3,\ldots&gt;\)</span> is given by</p>
<div class="math">
\begin{equation*}
\displaystyle G(z)=\dfrac{z}{(1-z)^2}
\end{equation*}
</div>
<p>Hence, to find the sum, it's simply</p>
<div class="math">
\begin{align*}
\displaystyle \dfrac{1}{1-z}\, G(z)=\dfrac{z}{(1-z)^3}\\ \implies [z^n]\dfrac{1}{1-z}\, G(z)=\sum_{k=1}^n k = \dbinom{n+1}{2}
\end{align*}
</div>
<p>We can then proceed to find more complicated sums like</p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{k=1}^n k^2
\end{equation*}
</div>
<p>which are usually done in high school by mathematical induction, but never shown how to derive in the first place.
To derive it from g.f., we must first find the g.f. for , which can be easily obtained by differentation. i.e.</p>
<div class="math">
\begin{equation*}
\displaystyle z\, \dfrac{d}{dz}\left(\frac{z}{(1-z)^2}\right)=\dfrac{z+z^2}{(1-z)^3}
\end{equation*}
</div>
<p>and the sum of the squares is</p>
<div class="math">
\begin{equation*}
\displaystyle [z^n]\dfrac{z+z^2}{(1-z)^4}=\dbinom{n+2}{3}+\dbinom{n+1}{3}=\dfrac{1}{6} \, {\left(2 \, n + 1\right)} {\left(n + 1\right)} n
\end{equation*}
</div>
<p>which can be verified by Sage</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_bd46af4501d74168b96eb14ebb3c27a9-1">1</a>
<a href="#rest_code_bd46af4501d74168b96eb14ebb3c27a9-2">2</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_bd46af4501d74168b96eb14ebb3c27a9-1"></a><span class="n">var</span><span class="p">(</span><span class="s1">'n'</span><span class="p">);</span>
<a name="rest_code_bd46af4501d74168b96eb14ebb3c27a9-2"></a><span class="n">show</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
</pre></td>
</tr></table>
<ol class="loweralpha simple" start="2">
<li>Summation of infinite series</li>
</ol>
<p>For this purpose, the dummy variable in the g.f. is replaced by a constant to obtain the closed form. E.g.
i)</p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{i\ge 0}\frac{1}{5^i}
\end{equation*}
</div>
<p>We have the g.f. for <span class="math">\(&lt; 1,1,1,\ldots &gt;\)</span></p>
<div class="math">
\begin{align*}
\displaystyle G(z)=\dfrac{1}{1-z}\\ \implies G(1/5)=\dfrac{5}{4}
\end{align*}
</div>
<ol class="lowerroman simple" start="2">
<li>We can also solve seemingly complicated sums like</li>
</ol>
<div class="math">
\begin{equation*}
\displaystyle \sum_{i\ge 0} \dfrac{i^2\, F_i}{12^i}
\end{equation*}
</div>
<p>where <span class="math">\(F_i\)</span> is the <span class="math">\(i^{th}\)</span> fibonacci term.</p>
<p>The g.f. for <span class="math">\(F_i\)</span> can be shown to be (derived from the linear recurrence relation)</p>
<div class="math">
\begin{equation*}
\displaystyle G(z)=\dfrac{z}{1-z-z^2}
\end{equation*}
</div>
<p>Next, obtain the g.f. for <span class="math">\(i^2 F_i\)</span></p>
<div class="math">
\begin{equation*}
\displaystyle G_1(z)= z\, D\left(z\, D\left( \dfrac{z}{1-z-z^2} \right) \right) = \dfrac{z^5 - z^4 + 6\, z^3 + z^2 + z}{(1-z-z^2)^3}
\end{equation*}
</div>
<p>where <span class="math">\(D\)</span> is the differential operator <span class="math">\(d/dz\)</span> and</p>
<div class="math">
\begin{equation*}
\displaystyle \sum_{i\ge 0} \dfrac{i^2\, F_i}{12^i} = G_1(1/12) = \dfrac{279804}{2248091} \approx 0.124462933217561
\end{equation*}
</div>
<p>In Sage, it's written as</p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#rest_code_4e2df57a049a448ea4fb32b6184e5dbd-1">1</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_4e2df57a049a448ea4fb32b6184e5dbd-1"></a><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
</pre></td>
</tr></table>
</div>
<div class="section" id="as-probability-g-f-and-obtain-expected-values">
<h2>3 As probability g.f. and obtain expected values</h2>
<p>In probability g.f., the coefficients are the probability of occurance of the value. The p.g.f. for a die with 6 faces numbered 1 to 6 is given by</p>
<div class="math">
\begin{equation*}
\displaystyle P(x)=\dfrac{x+x^2+x^3+x^4+x^5+x^6}{6}
\end{equation*}
</div>
<p>and the probability of the sums when two dice are thrown</p>
<div class="math">
\begin{equation*}
\displaystyle P_2(x)=P(x)^2=\frac{1}{36} \, x^{12} + \frac{1}{18} \, x^{11} + \frac{1}{12} \, x^{10} + \frac{1}{9} \, x^{9} + \frac{5}{36} \, x^{8} + \frac{1}{6} \, x^{7} + \frac{5}{36} \, x^{6} + \frac{1}{9} \, x^{5} + \frac{1}{12} \, x^{4} + \frac{1}{18} \, x^{3} + \frac{1}{36} \, x^{2}
\end{equation*}
</div>
<p>and the expected value shown when the die is thrown:</p>
<div class="math">
\begin{equation*}
\displaystyle E_1=P'(1)=\dfrac{7}{2}
\end{equation*}
</div>
<p>and when two dice are thrown:</p>
<div class="math">
\begin{equation*}
\displaystyle E_2=P_2'(1)=\dfrac{7\cdot 2}{2}
\end{equation*}
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/diophantine-equations/" rel="tag">diophantine equations</a></li>
            <li><a class="tag p-category" href="../../categories/expected-value/" rel="tag">expected value</a></li>
            <li><a class="tag p-category" href="../../categories/generating-function/" rel="tag">generating function</a></li>
            <li><a class="tag p-category" href="../../categories/infinite-series/" rel="tag">infinite series</a></li>
            <li><a class="tag p-category" href="../../categories/probability/" rel="tag">probability</a></li>
            <li><a class="tag p-category" href="../../categories/sage/" rel="tag">sage</a></li>
            <li><a class="tag p-category" href="../../categories/summation/" rel="tag">summation</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../interesting-images-2/" rel="prev" title="Interesting images - 2">Previous post</a>
            </li>
            <li class="next">
                <a href="../josephus-problem-c-versus-j/" rel="next" title="Josephus problem -- C versus J">Next post</a>
            </li>
        </ul></nav></aside><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script></article>
</div>
        <!--End of body content-->

        <footer id="footer"></footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
